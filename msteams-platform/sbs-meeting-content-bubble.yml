### YamlMime:Tutorial
title: Generate in-meeting notifications
metadata:
  title: Generate in-meeting notifications
  description: With this learning module, learn how to send reply to in-meeting notifications using bot in Teams with attendees.
  audience: Developer
  level: Beginner
  ms.date: 12/03/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: apps-in-teams-meetings/build-tabs-for-meeting.md
  nextTutorialTitle: Read more to enable and configure apps for meetings 
  ms.custom: mvc
  ms.localizationpriority: high
items:
- durationInMinutes: 1
  content: |
    Microsoft Teams helps you to generate and interact with in-meeting notifications using a bot.

    **Key features of in-meeting notifications**:

    * View agenda items listed in an Adaptive Card.
    * Select any option in the given agenda.
    * Submit your feedback on either in-meeting notifications or Adaptive Card sent in chat.
    * Send targeted notifications to a specific user in a meeting.
    
    > [!NOTE]
    > In-meeting notifications is available only for Azure AD users and not for anonymous users.
    
    This step-by-step guide helps you to generate in-meeting notifications using a bot in Teams meeting. You'll see the following output:

      :::image type="content" source="~/assets/images/meeting-content-bubble/desktop-and-mobile-image-final.png" alt-text="Screenshot shows the final output of in-meeting notification.":::

     

- title: Prerequisites
  durationInMinutes: 1
  content: |
    The following are the prerequisites:

    * Ensure that you have a working knowledge of the [CSharp language](/dotnet/csharp/fundamentals/tutorials/how-to-display-command-line-arguments).
    * Ensure that you install the following tools and set up your development environment:  

     | &nbsp; | Install | For using... |
     | --- | --- | --- |
     | &nbsp; | [Microsoft Teams](https://www.microsoft.com/microsoft-teams/download-app) | Microsoft Teams to collaborate with everyone you work with through apps for chat, meetings, and call-all in one place.|
     | &nbsp; | [Visual Studio 2022](https://visualstudio.microsoft.com)<br> | You can install the enterprise version in Visual Studio 2022, and install the workloads. Install one of the following two workloads:<br> • **ASP.NET and web development** <br> • **.NET Core cross-platform development** |
     | &nbsp; | [.NET Core SDK](https://dotnet.microsoft.com/en-us/download) | Customized bindings for local debugging and Azure Functions app deployments. Use the latest version or install the portable version. |
     | &nbsp; | [ngrok](https://ngrok.com/download) | Teams app features (conversational bots, message extensions, and incoming webhooks) require inbound connections. A tunnel connects your development system to Teams. It isn't required for apps that only include tabs. This package is installed within the project directory (using npm `devDependencies`). |
    
      > [!NOTE]
      > After downloading ngrok, sign up and install [authtoken](https://ngrok.com/download).

- title: Set up local environment
  durationInMinutes: 1
  content: | 

   1. Open [Microsoft Teams Samples](https://github.com/OfficeDev/Microsoft-Teams-Samples).
   1. Select **Code**.
   1. From the dropdown menu, select **Open with GitHub Desktop**.

      :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-clonerepository_1.png" alt-text="Screenshot shows the Microsoft-Teams Samples Clone repository with Open with GitHub Desktop highlighted in red under Code.":::

   1. Select **Clone**. 

      > [!NOTE]
      > If you encounter the error **Filename too long** apply the git command `git config --system core.longpaths true` in your administrator terminal of choice.

- title: Create and register your bot 
  durationInMinutes: 5
  content: |
    The following steps help you to create and register your bot in Azure portal.

    * Create Azure Bot resource to register bot with Azure Bot Service.
    * Create client secret to enable SSO authentication of the bot.
    * Add Teams channel to deploy the bot.
    * Use ngrok to create a tunnel to your web server's endpoints.
    * Add messaging endpoint to the ngrok tunnel you created.

    **To create Azure Bot resource**

    1. Go to the [Azure portal](https://portal.azure.com/).
    1. Select **Create a resource**.
    1. In the search box, enter **Azure Bot**.
    1. Select **Enter**.
    1. Select **Azure Bot**.

        :::image type="content" source="./assets/images/azure-bot_1.png" alt-text="Screenshot of Azure bot with Create option highlighted in red.":::

    1. Select **Create**.
    1. Enter required bot handle name in **Bot handle**.
    1. Select your **Subscription** from the dropdown list.
    1. Select your **Resource group** from the dropdown list.
     
        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-review-plus-create_1.png" alt-text="Screenshot shows to create an Azure bot with bot handle details.":::

       To create a new resource group, select **Create new** > enter resource name > select **OK**. Select the required location from **New resource group location** dropdown list.
       
         :::image type="content" source="~/assets/images/bots/newresource.png" alt-text="Screenshot of Create resource Azure bot with location highlighted in red.":::

    1. In the **Microsoft App ID** section, by default **Create new Microsoft App ID** is selected. 
    
       You can also select **Use existing app registration** and enter existing **App ID**, **App tenant ID**, and **MSI resource ID**.

       > [!NOTE]
       > You can't create more than one bot with the same **Microsoft App ID**.

    1. Select **Type of App** as **Multi Tenant**.

    1. Select **Review + create**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/Review-create_1.png" alt-text="Screenshot shows the create resource Azure bot with Type of App and Review plus Create option highlighted in red.":::

    1. If the validation passes, select **Create**.

        It takes a few moments for your bot service to be provisioned.

    1. Select **Go to resource**. 

         :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-botdeployment_1.png" alt-text="Screenshot shows the deployment with Go to resource option highlighted in red.":::
        
        Your Azure bot is created.

         :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-creating-resource-group_1.png" alt-text="Screenshot shows the Azure bot resource created.":::

    **To create client secret**

      Perform the following steps if you've created a new **Microsoft App ID**:

    1. In the left panel, select **Configuration**. 

       > [!TIP]
       > Save the **Microsoft App ID** or **Client ID** for future reference.      

    1. Next to **Microsoft App ID**, select **Manage Password**.

       :::image type="content" source="~/assets/images/manage-bot-label_1.png" alt-text="Screenshot shows the configuration with Manage option highlighted in red.":::

    1. In the **Client secrets** section, select **New client secret**. 

         :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-newclientsecret_1.png" alt-text="Screenshot shows the configuration with New client secret option highlighted in red.":::
        
       The **Add a client secret** window appears.  

    1. Enter **Description**.
    
    1. Select **Add**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-clientsecret_1.png" alt-text="Screenshot shows to add a client secret with Description and Add option highlighted in red.":::

    1. In the **Value** column, select **Copy to clipboard**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-client-secret_1.png" alt-text="Screenshot shows the Value of client secret with copy option highlighted in red.":::
       
       > [!TIP]
       > Save the **Client secrets** value or app password for future reference.

    **To add the Teams channel**

    1. Select **Home**.

    1. Select your bot from **Recent resources**.

    1. Select **Channels** in the left pane and select **Microsoft Teams** <img src="~/assets/images/bots/teamsicon.png" alt="Teams icon" width="20"/>.

        :::image type="content" source="~/assets/images/adaptive-cards/channel-teams.png" alt-text="Screenshot shows the Channels with Microsoft Teams highlighted in red.":::

    1. Select **Microsoft Teams** <img src="~/assets/images/bots/teamsicon.png" alt="Teams icon" width="20"/>.

    1. Select the checkbox to accept the **Terms of Service**.
    
    1. Select **Agree**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-terms_1.png" alt-text="Screenshot shows the Terms of service with Agree option highlighted in red.":::

    1. Select **Apply**.
    
    **To create a ngrok tunnel**

    Use ngrok or Command Prompt to create a tunnel to your locally running web server's publicly available HTTPS endpoints. Run the following command in ngrok:

     ```bash
     ngrok http --host-header=localhost 3978
     ```

     > [!NOTE]
     > While creating ngrok tunnel, use `localhost 5000` instead of `3978` if you choose **Command line** to run your app.
     
     > [!TIP]
     > If you encounter **ERR_NGROK_4018**, follow the steps provided in the Command Prompt to sign up and authenticate ngrok. Then run the `ngrok http --host-header=localhost 3978` command.
    
    
    **To add messaging endpoint**

    1. From ngrok, copy the HTTPS URL.

       :::image type="content" source="../msteams-platform/assets/images/ngrok-url_2.png" alt-text="Screenshot shows the ngrok with HTTPS URL highlighted in red.":::

        > [!NOTE]
        > The HTTPS URL in your ngrok is your fully qualified domain name.
        > The `WebAppDomain` is a fully qualified domain name that doesn't include `https://` in it.

    1. In **Settings** for the Azure bot that you created, select **Configuration**.

    1. In **Messaging endpoint**, use the HTTPS URL available from ngrok and at the end of the URL add **/api/messages**.

         :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-config-messaging-end-point_1.png" alt-text="Screenshot shows the configuration with Messaging Endpoint highlighted in red.":::

    1. Select **Apply**.

        You have successfully set up a bot in Azure Bot Service.

- title: Update the Azure AD app registration
  durationInMinutes: 1
  content: | 

    1. Go to the [Azure portal](https://portal.azure.com/).

    1. Select **Azure Active Directory**.

    1. In the left panel, select **App Registrations**.

    1. Select your bot.

    1. Under **Manage**, select **Expose an API**.

    1. Select **Set**.

    1. Set the **Application ID URI** in the form of `api://your ngrok/botid-{AppID}`.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-set-api_1.png" alt-text="Screenshot shows to Set the App ID URI with Save option highlighted in red.":::

       The following image shows the domain name:
        
         :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-exposeapi_1.png" alt-text="Screenshot shows the Expose an API showing application ID URI.":::

        > [!NOTE]
        > If you're using a tunneling service such as ngrok, ensure you update the value whenever your ngrok subdomain changes.
        > `For example: api://f631****.ngrok.io/92c11075-c629-4a1e-ab58-02b4fd4204c2`, where `f631****.ngrok.io` is the new ngrok subdomain name.

    1. Select **Add a scope**. 

        :::image type="content" source="~/assets/images/meetings-side-panel/selectscope_1.png" alt-text="Screenshot shows to Add Scope with Add a scope highlighted in red.":::
            
    1. Enter `access_as_user` as the **Scope name**.
  
    1. Set **Who can consent?** to `Admins and users`.
  
    1. To configure the admin and user consent prompts with appropriate values for `access_as_user` scope, provide the following information in the fields:
    
         * Enter `Teams can access the user’s profile` as **Admin consent display name**.

         * Enter `Allows Teams to call the app’s web APIs as the current user` as **Admin consent description**.

         * Enter `Teams can access the user profile and make requests on the user’s behalf` as **User consent display name**.

         * Enter `Enable Teams to call this app’s APIs with the same rights as the user` as **User consent description**.
  
       The following image shows the fields and the values:

          :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-access-as-user_1.png" alt-text="Screenshot shows to Add a scope with Add scope highlighted in red.":::

    1. Ensure that **State** is set to **Enabled**.
  
    1. Select **Add scope** to save.


       > [!NOTE]
       > The **Scope name** should match with the **Application ID** URI with `/access_as_user` appended at the end.
           `api://****.ngrok.io/00000000-0000-0000-0000-000000000000/access_as_user`
  
        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-add-scope_1.png" alt-text="Screenshot shows to Add a scope with application ID URI highlighted in red.":::

    1. In the **Authorized client applications** section, identify the applications that you want to authorize for your app’s web application. 

    1. Select **Add a client application**. 

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-selectclientapp_1.png" alt-text="Screenshot shows the Authorised client application with Add a client application.":::

    1. Enter **Client ID**: `1fec8e78-bce4-4aaf-ab1b-5451cc387264` for Teams mobile or desktop application. 

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-addclientapp1.png" alt-text="Screenshot shows to Add a client application with client ID.":::

       You can enter **Client ID**: `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` for Teams web application.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-addclientapp2.png" alt-text="Screenshot shows to Add a client application with client ID 2.":::

    1. Select **Authorized scopes**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-add-client-app_1.png" alt-text="Screenshot shows the Authorized scopes.":::

       The following image displays the Client ID:

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-client-applications.png" alt-text="Screenshot shows the Client IDs":::

    1. In the left panel, select **API Permissions**. 

       > [!NOTE]
       > Users need to consent to these permissions only if the Azure AD app is registered in a different tenant.

    1. Select **Add a permission**.

        :::image type="content" source="~/assets/images/meetings-side-panel/add-permission_1.png" alt-text="Screenshot shows to Add a Permission with Add a permission highlighted in red.":::

    1. Select **Microsoft Graph**.

    1. Select **Delegated permissions**.

    1. Add the following permissions:
         * **email**
         * **offline_access**
         * **OpenId**
         * **profile**
         * **User.Read**

    1. Select **Add permissions**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-otherpermissions.png" alt-text="Screenshot shows the Add permissions":::

    1. From the left panel, select **Authentication** to set a redirect URI. 

       > [!NOTE]
       > If an app isn't granted IT admin consent, users must provide consent the first time they use an app.
               
         1. Select **Add a platform**.
         1. Select **Web**.

             :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-platform-web_1.png" alt-text="Screenshot shows the authentication with Add  a platform and Web highlighted in red.":::

         1. Enter the redirect URI for your app by appending `auth-end` to fully qualified domain name: `https://your ngrok/auth-end`.

         1. Enable **Implicit grant and hybrid flows** by selecting the following checkboxes:
             * **ID tokens**
             * **Access tokens**
   
         1. Select **Configure**.

             :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-content-bubble-config-web_1.png" alt-text="Screenshot shows to configure with URI and access tokens highlighted in red.":::

- title: Set up app settings
  durationInMinutes: 1
  content: |
    1. Go to **appsettings.json** in cloned repository.

        :::image type="content" source="~/assets/images/meeting-content-bubble/navigate-to-meeting-content-bubble-repo_1.png" alt-text="Screenshot shows the App settings location.":::

    1. Open the **appsettings.json** file in Visual Studio and update the following information:  

         * Set `"MicrosoftAppId"` to your bot's **Microsoft App ID**.
         * Set `"MicrosoftAppPassword"` to your bot's client secret ID value.
         * Set `"BaseURL"` to your `webAppDomain`.

          > [!NOTE]
          > `WebAppDomain` is your ngrok domain.

          :::image type="content" source="~/assets/images/meeting-content-bubble/appsettings-json1_1.png" alt-text="Screenshot shows the App settings.":::

- title: Set up manifest file
  durationInMinutes: 1
  content: |
    1. Go to **manifest.json** in cloned repository.
    
    1. Open the **manifest.json** file in Visual Studio and make the following changes:
    
         * Set `ID` to **Microsoft App ID**.
         * Set `botId` to **Microsoft App ID**.
         * Set `webApplicationInfo` Id to **Microsoft App ID**.
         * Set `validDomains` to **Web App Domain Name**.

          > [!NOTE]
          > `WebAppDomain` is your ngrok domain.
          > If the ngrok ID end with `*.ngrok-free.app` valid domain is optional.

         :::image type="content" source="~/assets/images/meeting-content-bubble/manifest-set_1.png" alt-text="Screenshot shows the Manifest cloned repository.":::

- title: Build and run the service
  durationInMinutes: 1
  content: |
    **To build and run the service using Visual Studio**

       1. Open **Visual Studio**.
       1. Go to **File** > **Open** > **Project/Solution**.
    
           :::image type="content" source="~/assets/images/meeting-content-bubble/meeting-token-generator-VSopenfile_1.png" alt-text="Screenshot shows the Visual Studio with File, Open and Project-Solution highlighted in red.":::

       1. Open the **InMeetingNotifications.sln** file in Visual Studio Code.

           :::image type="content" source="~/assets/images/meeting-content-bubble/proj-sln_1.png" alt-text="Screenshot shows the cloned repository with InMeetingNotifications.sln file highlighted in red.":::

       1. Press **F5** to run the project.

          A webpage opens with a message **Your bot is ready!**.

           :::image type="content" source="~/assets/images/meeting-content-bubble/your-bot-is-ready.png" alt-text="Screenshot shows the Echo bot showing your bot is ready."::: 
    
- title: Add in-meeting notifications app to Teams
  durationInMinutes: 1
  content: |

    1. In your cloned repository, go to **csharp > Resources > Manifest**.

    1. Create a .zip with the following files that are present in the **Manifest** folder: 
       * manifest.json
       * icon-outline.png
       * icon-color.png

        :::image type="content" source="~/assets/images/meeting-content-bubble/create-manifest-zip_1.png" alt-text="Screenshot shows the cloned repository with path and in-meeting notification demo zip file highlighted in red."::: 
    
    1. Create a meeting with a few presenters and attendees.
   
    1. After the meeting is created, select **+ Apps** to add an App.

        :::image type="content" source="~/assets/images/meeting-content-bubble/add-an-app.png" alt-text="Screenshot shows the Teams call with Apps option highlighted in red."::: 
   
    1. In the pop-up window, select **Manage apps**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/manage-apps_1.png" alt-text="Screenshot shows the Teams apps with Manage apps highlighted in red."::: 
   
    1. Select **Upload an app** > **Upload a custom app**. 

        :::image type="content" source="~/assets/images/meeting-content-bubble/upload-custom-app_1.png" alt-text="Screenshot shows the Teams apps with Upload a custom app highlighted in red."::: 

    1. Select the upload .zip file that you created in the **Manifest** folder and select **Open**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/Zip-file_1.png" alt-text="Screenshot shows the manifest folder with in-meeting notification demo zip file and Open option highlighted in red.":::

    1. Select **Add**.

        :::image type="content" source="~/assets/images/meeting-content-bubble/content-bubble-demo_1.png" alt-text="Screenshot shows the Targeted notification with Add option highlighted in red."::: 

    1. The **Manage apps** section displays the list of applications.

        :::image type="content" source="~/assets/images/meeting-content-bubble/Manage.png" alt-text="Screenshot shows the section showing the list applications"::: 

    1. Go to Teams meeting chat.
    
    1. **In-meeting notifications Demo** app sends an automatic reply to the meeting chat. You can send a targeted notification and also a in-meeting notification.

         :::image type="content" source="~/assets/images/meeting-content-bubble/desktop-and-mobile-image-final.png" alt-text="Screenshot shows the suggestions in the Teams chat."::: 
      
- title: Complete challenge
  durationInMinutes: 1
  content: |
    Did you come up with something like this?

     :::image type="content" source="~/assets/images/meeting-content-bubble/final-result-targeted-notification.png" alt-text="Screenshot shows the final output after the selection of targeted notification.":::

     :::image type="content" source="~/assets/images/meeting-content-bubble/send-targeted-notification.png" alt-text="Screenshot shows the final output pop-up for the send targeted notification.":::

     :::image type="content" source="~/assets/images/meeting-content-bubble/send-inmeeting-notification.png" alt-text="Screenshot shows the final output pop-up for the send in-meeting notification.":::


- content: |
    You've completed the tutorial to get started with generate in-meeting notifications app.

