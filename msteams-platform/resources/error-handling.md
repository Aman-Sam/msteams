---
title: Error handling messages
description: In this article, display all the error handling messages for reference. 
ms.topic: reference
ms.localizationpriority: high
ms.author: v-vanisreeth
ms.date: 10/06/2023
---
# Error handling messages  

## Apps in meetings

|Error message                 |Scenario                                |Resolution |
|:-----------------------------|:---------------------------------------|:---------|
|No specific error code <br>**Reason**: Session ID changes every time the page is reloaded in the custom app on MS Teams Desktop App.|A custom app in Microsoft Teams Desktop App uses cookies and a session ID to keep track of temporary settings for tasks. The issue is session ID changes on every page reload.                                        |         |
|BadArgument <br>**Reason**: Unknown attachment type     |The developer is trying to attach a PDF file to a Microsoft Teams bot and encounters an error.        |Avoid using cookies in Teams apps as they can cause issues when switching between Desktop and Web or different devices. Instead, store state server-side in a database or other store, keyed on the user's AadObject ID (their unique Azure Active Directory user guid), which remains consistent across all platforms.|

[Back to top](#error-handling-messages)

## Adaptive card

|Error message           |Scenario                               |Resolution  |
|------------------------|---------------------------------------|------------|
|Unable to render dynamic data inside the AdaptiveCard template for user mentions in Teams.    | The developer is trying to create a dynamic AdaptiveCard to mention users in Teams. They're facing an issue with rendering dynamic data inside the template. They have tried to serialize a JSON with the same $data structure with the name of the user mentioned but it doesn't render anything.        |Currently, there's no support for sending a dynamic array to the entity property in Microsoft Teams. For mentioning a user, you need to repeat the entity block, not the text block. For more information, see [Adaptive Cards Template Language](/adaptive-cards/templating/language)|

[Back to top](#error-handling-messages)

## Bots

|Error message              |Scenario                               |Resolution  |
|---------------------------|---------------------------------------|------------|
|ServiceError <br>**Reason**: Could not find Connection Setting with name teamsAuth.    | The developer was trying to add SSO for a notification bot using Teams Toolkit. Despite following the documentation and adding the OAuth connection in the bot, the developer was encountering an error stating that the connection setting 'teamsAuth' could not be found.        |Ensure that the OAuth connection name is correctly added to the .env file as mentioned in the documentation. If the issue persists, try using the TeamsBotSSOPrompt function by registering an AAD App for bot authentication. If the problem still persists, consider filing an issue in the TeamsFx repo for further assistance.|
|BadArgument <br>**Reason**: Unknown attachment type|The developer is trying to attach a PDF file to a Microsoft Teams bot and encounters an error.|The developer should check the sample code for file sharing on MS Teams provided by Microsoft. Additionally, the 'supportsFiles' option needs to be enabled in the manifest for the bot to support file attachments.|
|Bad Request - Error in query syntax. <br>**Reason**: The error occurred while trying to get detailed user information using GetUserProfile() in Microsoft Power Virtual Agents Flow Template|The developer was trying to get detailed user information using Microsoft Power Virtual Agents in Microsoft Teams. The error occurred when the developer tried to use GetUserProfile() function with the input as 'first(outputs('Search_for_users_(V2)')?['body/value'])?['UserPrincipalName']'.|Ensure that the necessary camera and storage permissions are granted on the Android device. Check the app's permission settings and make sure the camera and storage permissions are enabled. If the issue persists, consider debugging the code to identify any potential issues specific to Android.  Instead of passing in display name, pass in UserID. This way, the call to SearchForUsers() is not needed. Correcting the input to GetUserProfile() function should resolve the issue.|
|BadArgument Failed to decrypt pairwise ID| The error occurred when attempting to create a conversation between a bot and a user in Teams using the POST request to the [https://smba.trafficmanager.net/amer/v3/conversations](https://smba.trafficmanager.net/amer/v3/conversations) endpoint.|Verify the values of each parameter in the request, especially the ID given for the member parameter. If the error persists, try executing the request at a different time as it may be a temporary issue.|
|The deep link does not save the subEntityId param when clicked in Microsoft Teams chat.|A developer is trying to use a deep link in Microsoft Teams chat, but the subEntityId param is not being saved when the link is clicked.Ensure that the 'context' is not web encoded. Try using the following format: [https://teams.microsoft.com/l/entity/c38259cb-cd15-4797-b634-098bcea43f9a/index1?webUrl=https://google.com/&label=Google&context={"subEntityId":39138959}|](<https://teams.microsoft.com/l/entity/c38259cb-cd15-4797-b634-098bcea43f9a/index1?webUrl=https://google.com/&label=Google&context={"subEntityId":39138959}>|)
|Error Message: 412 <br>**Reason**: The server crashes when trying to send a 412 response in the onInvokeActivity in the server/bots/botActivityHandler.js.|The developer is using Node 16 and npm 8 in the sample app-sso and encounters a server crash when the botAdaptivity attempts to return a 412 response. The bot-builder does not catch and process this exception, causing the app to crash.|Ensure that all required permissions are added and the configuration is correct. Check if admin consent has been granted for your graph API's. Also, consider adding exception handling in the server or elsewhere to catch and process this exception. An issue has been submitted to botbuilder-js and they have added this problem to their backlog.|
|invalid_grant <br>**Reason**:  Due to a configuration change made by your administrator, or because you moved to a new location, you must use multi-factor authentication to access.|The developer is trying to create a MS Teams chatbot using Python and is having difficulty obtaining the correct access token to read the user's group chat and interact with it. The user has multi-factor authentication enabled.|The developer needs to use interactive flows where user sign in is required. They should modify their code to use 'acquire_token_interactive' instead of 'acquire_token_by_username_password'. Also, they should add a redirect URI as '[http://localhost](http://localhost)' in their application.|
|Manifest.json validation errors and meeting join events not getting delivered.|The developer is trying to run a Microsoft Teams bot for meeting events but is encountering validation errors with the manifest.json file. Additionally, the bot is not receiving meeting join events, although chat messages are arriving.| 1. Ensure that the manifest.json file is correctly formatted and adheres to the schema. 2. Check the bot's permissions and scopes to ensure it has the necessary access to receive meeting join events.  3. Refer to the sample provided by Microsoft at <https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/meetings-events/csharp> for guidance. 4. If the issue persists, reach out to Microsoft support for further assistance.|
|Error finding key for token <br>**Reason**: The system is unable to find the key for the token while testing the command bot app.|The developer was testing a command bot app in Microsoft Teams. When they used @mention to send a 'helloWorld' command to the bot, they received no response and encountered an error message in the VSCode terminal stating 'Error finding key for token'.|1. Ensure that the bot is properly configured and the token is correctly generated. 2. Check if the RSA public key is correctly set up and matches with the token. 3. Make sure all prerequisites and steps are correctly followed as per the given document. 4. Try to reproduce the issue in a different environment or setup to isolate the issue. 5. If the issue persists, consider reaching out to Microsoft Teams Developer Community or escalating the issue via the provided link.|
|Error Message: 400 <br>**Reason**: Bot is not responding when using app service url as messaging endpoint.|The developer is trying to use a bot with a deployed service url in Microsoft Teams. The bot works fine with ngrok but fails to respond when using the app service url.|Check if any policy is blocking the request from Teams to App service. If so, modify the policy to allow the request. Also, ensure that the domain where your app is deployed is added under the 'validDomains' section of the manifest. If not using SSO, enter a dummy string value in the 'resource' field of the 'webApplicationInfo' section of your app manifest.|
|Error Message: DEP0005, DEP0018 <br>**Reason**: The bot stopped responding due to deprecation of Buffer() and unhandled promise rejections.|A bot built with Microsoft Bot Framework Node.JS SDK, deployed on a windows server, stopped responding after working well for over a year.|Replace the deprecated Buffer() methods with the new Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods in your code. Also, handle promise rejections properly in your code to avoid termination of the Node.js process.|

[Back to top](#error-handling-messages)

## Developer Portal

|Error message              |Scenario                               |Resolution  |
|---------------------------|---------------------------------------|------------|
|Manifest Error <br>**Reason**: Manifest is invalid due to missing 'name.short' and 'name.full' properties in the localization file   | The developer was trying to upload the manifest for a Teams app with localization. The Teams app started throwing an error stating that the manifest is invalid due to missing 'name.short' and 'name.full' properties in the localization file.|Add 'name.short' and 'name.full' properties to the localization file. Even if the name of the application is not localizable, these fields are required in the localization file.|
|File not found <br>**Reason**:The file could not be found in the app package.| The developer is trying to import the 'Hello World' app package to the Developer Portal in Microsoft Teams. However, the import fails with an error message stating that the file could not be found in the app package. The developer has tried both generating the app package using the 'gulp' command and manually creating the app package, but the error persists.|The developer should manually update the color and outline icon file names in the manifest file and check if it works. If the issue persists, the developer should manually create a zip package of color, outline, and manifest file which is in the appPackage folder and check if it works. If the issue still persists, the developer should check the PR #525 for the updated changes.|
|Error Message: Error converting value "{{variable-name}}" to type 'System.Nullable`1[System.Guid]'. Path 'botId', line 1, position 31. Cannot use environment variable as Bot ID in Teams App Developer Portal.|The developer is trying to use an environment variable as a bot ID while creating a Teams App manifest using the Developer Portal.|Environment variables are not designed to be used in the GUID field. The developer should directly use the GUID value instead of the environment variable in the bot ID field.|
|514 SDK Initialization Failed - Please provide instrumentation key|The developer is trying to initialize the Teams SDK in web teams on Chrome browser but it's failing due to missing instrumentation key.|    Ensure that you have provided a valid instrumentation key while initializing the SDK. The instrumentation key is required for telemetry data. If you don't have one, you can create it in Azure portal.|

[Back to top](#error-handling-messages)

## Microsoft Graph

|Error message             |Scenario                               |Resolution  |
|--------------------------|---------------------------------------|------------|
|PreconditionFailed <br>**Reason**: PreconditionFailed-ETag mismatch for thread store resource.   | The error occurred while trying to create a group chat using the $batch API from MS Team Graph API.|Ensure that you are using the correct POST query while creating the group chat. After creating the group chat, try adding members to the chat using batch operation.|
|No authorization information present No authorization information present on the request.|The developer is trying to call a simple Graph API from the explorer but is encountering an error even though all required permissions have been granted.|Ensure that there is an admin grant for the required permissions. You can also decode your token at [https://jwt.ms](https://jwt.ms) and check in scopes whether the required permissions are available.|
|PS>TerminatingError(Import-Module) Could not load file or assembly 'System.Management.Automation, Version=7.2.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.|The error occurred when a PowerShell script was executed via Intune on devices other than the developer's own. The script was intended to deploy corporate images to each user's workstation for use as Microsoft Teams backgrounds. The script worked fine when executed locally or on the developer's machine, but failed on other laptops when executed through Intune.|1. Downgrade the PnP Powershell to version 1.12.0 using the commands: 'Uninstall-Module PnP.Powershell' and 'Install-Module -Name PnP.PowerShell -RequiredVersion 1.12.0'. 2. If the script is being run in an Azure DevOps release pipeline, force the PowerShell task to run with PowerShell Core instead of the default V5. This can be done by updating the task settings under Advanced. 3. If the script is being run via Intune, check if there is an option to enforce using PowerShell Core. 4. Alternatively, host the image files on an accessible website and use 'Invoke-WebRequest' to remove the need for interaction with PnP.Powershell.|
|Forbidden UnknownError|The developer is trying to retrieve messages from a public Microsoft Teams channel that they are not a part of, using Microsoft Graph APIs.|Ensure that the access token has at least ChannelMessage.Read.All permission. If not, add the required permission and try again. Check the functionality in the Graph Explorer first. Note that only team members, owners, or admins can access GET /teams/team-id/ and even admins cannot pull messages from channels they are not part of. This is by design.|

[Back to top](#error-handling-messages)

## Webhook and Connectors

|Error message              |Scenario                              |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|Error Message: 403 Forbidden error when trying to do an HttpPOST request via a message card, delivered via a Custom Connector.| The developer is trying to create a custom connector for their application in Teams. They are able to post message cards using PostMan, but when they try to post a message card with an Action (HttpPOST) and execute it on the click of a button, they receive a 'Failed to send' message. Further inspection reveals that an API called Execute Action is returning a 403 forbidden error.|Check the permissions for the webhook.site URL. Make sure it is added as an Action URL in the connector developer dashboard and as a valid domain in the connector manifest.json. If the issue persists, try using a different webhook.site as suggested by the Microsoft Teams support.|
|Error encountered when trying to mention @webhook name in teams.|The developer is trying to invoke Azure functions from Outgoing webhooks in Microsoft Teams. They have created Outgoing webhooks in teams and added their Azure function URL in the callback URL. They have also copied their secret key from webhooks to Azure configuration. However, when they try to mention @webhook name in teams, they encounter an error.|The developer needs to create an HttpTrigger Azure function instead of just an HttpRequest function. They can refer to the provided code for creating an Azure HttpTrigger function. They can also refer to the provided document for more information on Azure functions and bindings.|

[Back to top](#error-handling-messages)

## Device capabilities

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|No Error Code  <br>**Reason**: Unable to launch camera in android mobile using the provided React-js code snippet| The developer is trying to launch the camera and gallery on both android and iPhone using a React-js code snippet in a Microsoft Teams app. The camera does not open on Android, only the gallery opens without multiple selection, while it works fine on iPhone.|Ensure that the necessary camera and storage permissions are granted on the Android device. Check the app's permission settings and make sure the camera and storage permissions are enabled. If the issue persists, consider debugging the code to identify any potential issues specific to Android.|
|10000 / SIZE_EXCEEDED  <br>**Reason**: The error occurs when users select more than a certain number of images using the microsoftTeams.media.selectMedia function, exceeding the total file size limit of ~30 MB.|The issue arises when users of the custom message extension, particularly on modern Android devices, select more than five images at once. Each image can be over 6MB, causing the function to fail due to the total file size limit.|The platform's size boundaries seem to be limited. You can change the maxMediaCount value as mentioned in the code. However, the exact limit may vary depending on the device and the size of the images. The engineering team is investigating ways to counter the platform size limit.|
|Option to disable developer preview no longer exists in the stated menu.|A user enabled the developer preview in Microsoft Teams and later found that the option to disable it no longer exists in the menu. The user was unable to disable the developer preview for a year.|The user should update the Teams version and check again. If the issue persists, the user should connect with the tenant admin to disable the policy. If the issue still persists, the user should reach out to Microsoft 365 Product Support.|
|This action can't be performed since the app does not exist or has been uninstalled.|The developer is creating a Microsoft Teams messaging bot that requires authentication/sign-in. The bot sends a non-reply message to the user that includes a hero card with a sign-in button. When the user receives the hero card and clicks the sign-in button, it displayes an error message.|1. Ensure that 'token.botframework.com' and 'login.microsoftonline.com' are added in the valid domain section of your app manifest. 2. If you are sideloading the app, be aware that installing/uninstalling the app can be buggy. Try closing and reopening your MS Teams client.|

[Back to top](#error-handling-messages)

## Authentication

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|403: disallowed_useragent  <br>**Reason**: 403 Google auth on Microsoft Teams mobile app returns |  The developer is trying to authenticate a Teams app using Google authentication on Android. The authentication process opens a popup but it redirects to an error page.|Ensure that the 'isExternal' parameter and two placeholder values in the existing url parameter are added to the authenticate() API to support external OAuth providers as suggested by Nivedipa-MSFT. If the issue persists, escalate it using the provided link.|
|Error Message:AuthFailed Failure to get the renewal token from microsoftTeams.authentication.getAuthToken({ }) on app load or for renewal when it expires.|The developer is trying to get the auth token for a personal app using microsoftTeams.authentication.getAuthToken({ }) method. The method is failing often and taking time to get the token. The token is only obtained on browser refresh/retry.|The developer is advised to set 'showLoadingIndicator' to 'false' and remove 'notifySuccess' and 'notifyFailure' calls. This is to simplify the process and avoid confusion between SSO in a tab and the way the 'loading' indicator works.|

[Back to top](#error-handling-messages)

## Sideloading

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|Error while importing the Teams custom app after unzipping, zipping, and re-importing.|The developer is trying to import a Teams custom app. The import works fine if the zip is exported and immediately re-imported. However, if the zip is exported, unzipped on a Mac or Windows computer, then re-zipped and re-imported, it fails.|Ensure that when zipping the files, only the three necessary files (manifest file, color and outline icon file) are selected and zipped. Do not zip the entire folder containing these files as it results in the files being buried in a folder which the dev portal is not expecting.|
|Error Message:403 <br>**Reason**:Failed to create an app in Azure Active Directory due to insufficient privileges.|A user is trying to upload a custom app through Teams but is encountering an error due to insufficient privileges.|Check if the E3 license includes Microsoft Teams. Ensure the user has either the Application Administrator or Application Developer role assigned. If not, assign one of these roles to the user. There might be a delay after assigning the role, so try again after some time. If the error persists, login with a Microsoft 365 Developer Account. If you don’t have one, consider joining the Microsoft 365 Developer Program.|

[Back to top](#error-handling-messages)

## Cards

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|iOS Teams app not showing card if the card contains a hyperlink with an ampersand|The developer is trying to display a card in the iOS Teams app that contains a hyperlink with an ampersand. Instead of displaying the card, the app only shows the message 'Sent a card'.|Ensure that the iOS and Teams versions are up to date. If the issue persists, share the card JSON for further investigation. It might be an issue with the way the hyperlink is parsed when it contains an ampersand. As a workaround, try encoding the ampersand in the URL.|
|OnTeamsMeetingStartAsync() and OnTeamsMeetingEndAsync() methods are not being called in a specific tenant, but work in a local demo tenant.| The developer is trying to use OnTeamsMeetingStartAsync() and OnTeamsMeetingEndAsync() methods in a specific tenant, but they are not being called. However, these methods work in a local demo tenant.|1. Confirm that the feature is available in public developer preview. 2. Ensure that 'OnlineMeeting.ReadBasic.Chat' permission is added. 3. Check the configuration of group owner consent settings for RSC in a team using the Azure AD portal. 4. Use Graph explorer to check whether the correct RSC permission is associated with the bot.|

[Back to top](#error-handling-messages)
