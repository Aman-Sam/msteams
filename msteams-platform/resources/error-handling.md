---

title: Error handling messages
description: In this article, display all the error handling messages for reference.
ms.topic: reference
ms.localizationpriority: high
ms.author: v-vanisreeth
ms.date: 10/06/2023
---

# Error handling messages  

## Adaptive Card

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Unable to render dynamic data inside the Adaptive Card template for user mentions in Teams. | A developer is trying to create a dynamic Adaptive Card for user mentions in Teams. The template fails to render anything even after using the same $data structure to serialize a JSON with the user's name. <br><br> **Source:** [View](https://stackoverflow.com/questions/74364152/send-data-array-to-an-adaptivecard-with-c) | Microsoft Teams doesn't support sending a dynamic array to the entity property. To mention a user, repeat the entity block and not the text block. For more information, see [Adaptive Cards Template Language](/adaptive-cards/templating/language).
**Code**: Not available <br><br>**Message**: URL with double quotes in Adaptive Card action isn't opening in Microsoft Teams on iOS. | A developer is using Logic apps to generate Actions in an Adaptive Card and pass a URL with double quotes. However, the URL fails to open when the Adaptive Card is sent to Microsoft Teams and the action button is selected. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6934) | Verify the URL and try a different one. Ensure the URL is properly encoded to handle special characters such as double quotes. Test the behavior on different platforms (Teams web, desktop, and iOS) to isolate the issue. If the problem persists, report the issue with all the relevant details for further investigation.
**Code**: Not available <br><br>**Message**: Adaptive Cards aren't fully occupying width in Microsoft Teams group channel after setting the `width: full` property.| A developer is trying to render Adaptive Cards in Microsoft Teams group channel with full width. By setting the `width: full` property, the Adaptive Cards aren't occupying the full width. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7468) | The team resolved the issue and rolled out the fix to the organization's tenant. You must ensure to use the latest version of Microsoft Teams desktop and web version in channel scope.
**Code**: Not available <br><br>**Message**: `replyTold` is coming null when user performs any action on the Adaptive Card in the emulator. | A developer is testing an Adaptive Card with yes or no action items in the emulator. When a user selects yes or no, the developer wants to update the card with a thank you message. However, the `replyTold`, which is needed for the update, is coming as null. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7540) | Follow these steps: <br/><br/>1. Verify the version of the Bot Framework Emulator being used. Its version should be v4. <br/><br/>2. Test the Adaptive Card again in the emulator. <br/><br/>3. If the issue persists, share a screen recording of the issue for further investigation.
**Code**: Not available <br><br>**Message**: Microsoft Teams doesn't post back the `data` property of `Action.Submit` if it's a string. |A developer is trying to send a Card to Teams with an `Action.Submit` data set to a string. However, Teams doesn't send it back in the value property of the message event. If the Data is an object, then Teams sends it back. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7581) | There's no workaround for this issue. A bug is raised and is under investigation. Monitor the original GitHub issue for updates.
**Code**: BadSyntax <br><br>**Message**: Failed to read card payload as JSON. | A developer is trying to add color to the text in an Adaptive Card using conditions in a bot that generates Adaptive Cards into the channel. <br><br> **Source:** [View](https://stackoverflow.com/questions/74211210/unable-to-add-condition-colouring-to-a-text-in-the-adaptive-card) | Follow these steps: <br/><br/>1. Install the Adaptive Card Templating for JavaScript library. <br/><br/>2. Use the if condition to set the color to good and attention. Ensure to use the `ACData.Template` function on the cardJson before expanding it with the data. <br/><br/>3. Use the resulting `finalCardJson` to send an Adaptive Card in the channel or as per the use case.
**Code**: 209 <br><br>**Message**: Invoke validation failed. User forbidden to perform action. | A developer is trying to use the `Refresh` action in an Adaptive Card in a one-to-one chat in Teams. The action works for the developer but not for the other user in the chat. The error occurs after the Teams cache is cleared and the chat is opened in a browser. <br><br> **Source:** [View](https://stackoverflow.com/questions/74273728/teams-refresh-adaptive-card-returns-209-error-in-group-chat) |The issue was resolved by adding a bot at the launch of the messaging extension. However, the bot wasn't automatically included in the group chat. The user employed the `OnTeamsMessagingExtensionFetchTaskAsync` method to verify the app's installation by retrieving member data. If the bot is absent from the conversation roster, the `GetAddMissedBotCard` method is invoked to add the bot.
**Code**: Not available. <br><br>**Message**: The Azure Logic app isn't capturing the input text from a Teams Adaptive Card, as the response isn't getting recorded. |A developer is attempting to incorporate the input text into their Azure Logic app, but the recording of the response isn't successful. <br><br> **Source:** [View](https://stackoverflow.com/questions/73875734/azure-logic-app-post-adaptive-card-and-wait-for-response) | Ensure to use the **Post Adaptive Card and wait for a response** action if the user expects a response from the card. The output of this action doesn't give any output options, so the user needs to format it manually. Use `Parse json` and enter input in the expression field: `@Outputs('adaptivecardname')?[body]`.

## Apps in meetings

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: No specific error code. <br><br>**Message**: Session ID changes every time the page reloads in the custom app on MS Teams desktop app. | An issue is occurring in a custom app on Microsoft Teams desktop app, which uses cookies and a session ID to track temporary settings for tasks. The session ID changes each time the page reloads. <br><br> **Source:** [View](https://stackoverflow.com/questions/74131632/ms-teams-desktop-app-changing-session-id-between-pages) | Avoid using cookies in Teams apps. They might cause problems when switching between desktop and web or different devices. Instead, store the state server-side in a database or another store, using the user's aadObjectId (their unique Microsoft Entra user GUID) as the key. This ID remains consistent across all platforms.
**Code**: Not available <br><br>**Message**: `OnTeamsMeetingStartAsync()` and `OnTeamsMeetingEndAsync()` methods aren't being called in a specific tenant, but work in a local demo tenant. | The developer is attempting to use `OnTeamsMeetingStartAsync()` and `OnTeamsMeetingEndAsync()` methods in a specific tenant, but they aren't being called. However, these methods function in a local demo tenant.<br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7226) | Follow these steps: <br/><br/>1. Verify that the feature is available in the public developer preview. <br/><br/> 2. Ensure that `OnlineMeeting.ReadBasic.Chat` permission is added. <br/><br/> 3. Review the configuration of group owner consent settings for RSC in a team using the Microsoft Entra admin center. <br/><br/> 4. Use Graph explorer to verify whether the correct RSC permission is associated with the bot.
**Code**: Upload failed File size too large. <br><br>**Message**: The file size limit for Adobe eSign feature is 10 MB. | The error occurs when trying to attach files larger than 10 MB using the Teams **Approvals** app for eSignature and approvals of documents. <br><br> **Source:** [View](https://stackoverflow.com/questions/73911852/ms-teams-approvals-upload-failed-file-size-too-large) | Ensure that the file size doesn't exceed the limit set by the Adobe eSign feature, which is 10 MB. If the files are large, consider compressing the files or using a different method to send them.

## Authentication

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: 403 <br><br>**Message**: Google auth on Microsoft Teams mobile returns 403: disallowed_useragent. | A developer tries to authenticate a Teams app using Google authentication on Android. The authentication process opens a popup, but it redirects to an error page. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6577) | Add the `isExternal` parameter and two placeholder values in the existing URL parameter to the `authenticate()` API to support external OAuth providers. If the issue persists, escalate it using the provided link.
**Code**: AuthFailed <br><br>**Message**: Failure to get the renewal token from microsoftTeams.authentication.getAuthToken({ }) on app load or for renewal when it expires. | A developer tries to get the auth token for a personal app using the `microsoftTeams.authentication.getAuthToken()` method. The method often fails and takes time to get the token; the token is only obtained upon browser refresh or retry. <br><br> **Source:** [View](https://stackoverflow.com/questions/72560252/failing-to-get-the-renewal-token-from-teams-microsoftteams-authentication-getaut) | Set `showLoadingIndicator` to false. This simplifies the process and avoids confusion between SSO in a tab and the way the loading indicator works. Also, remove `notifySuccess` and `notifyFailure` calls.
**Code**: Not available <br><br>**Message**: `getAuthToken()` method returns empty single sign-on (SSO) token in success callback. | A developer tries to fetch the SSO token using TeamsFx React SDK in an SSO Tab app. The token is fetched successfully when running the app using Teams Toolkit or when previewing or publishing the app from the Developer Portal. However, when the app is deployed in Ring 0, the SSO token is returned as an empty string. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1290) | Check the implementation of the `getAuthToken()` method. Ensure the correct ClientId is used across all environments. Verify the app manifest and app definition in Ring 0. If the issue persists, escalate to the Microsoft Support team for further investigation.
**Code**: Manifest Error <br><br>**Message**: Manifest doesn't contain the RSC permission to allow in-app purchases. | A developer tries to implement in-app purchases in a Microsoft Teams app. The app works fine on a test tenant but shows an error on a normal tenant. The error also occurs on a second account where the in-app purchase popup doesn't appear. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1788) | Follow these steps: <br/><br/>1. Validate the manifest using Teams store app validation in the Developer Portal. <br/><br/> 2. Follow the v1 implementation guide, remove the planInfo parameter and add a callback function inside. <br/><br/>3. Ensure to implement in-app purchases within the personal scope, as it doesn't support in channel scope.
**Code**: unknownAuthError <br><br>**Message**: The error occurs when the `authentication.getAuthToken()` function is called, returning `Error: unknownAuthError`. | A developer tries to get tokens from the current user logged in on Teams desktop app using the `authentication.getAuthToken()` function in the Teams SDK. The error occurs when testing on Teams desktop client (Windows and macOS). <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1307) | Several possible resolutions exist. <br/><br/>1. Proactively check for token expiration and ask the user to sign in again if the ID token isn't valid. <br/><br/>2. Catch the error in a callback passed into the acquiretoken ADAL JS function and ask the user to sign in again if the error occurs. <br/><br/>3. Add login.microsoftonline.com endpoint in browser extension or re-enable third party cookies in the browser if they're disabled. <br/><br/>4. Add two client applications to authorized client applications in Azure portal for Teams desktop or mobile or web client: `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` and `1fec8e78-bce4-4aaf-ab1b-5451cc387264`.
**Code**: SSO-Token <br><br>**Message**: SSO Token isn't getting generated for some users in Azure AD. | The issue occurs when users enter the Una Chat Bot in Microsoft Teams. The SSO Token should be automatically generated for all users, but it's not happening for some. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6654) | Update the Teams version and check again. If the issue persists, ensure that the application is correctly registered through Microsoft Entra ID for SSO. Check the user permissions and roles in Microsoft Entra ID. If the problem continues, escalate the issue using the provided link.
**Code**: Not available <br><br>**Message**: OAuth token for user authentication isn't working on iOS 16. | A developer uses an OAuth token from HTTP response to authenticate users. The authentication works on Android, desktop, and web platforms, but fails on iOS 16. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1553) | Follow these steps: <br/><br/>1. Check if the issue is specific to iOS 16 or all iOS versions. <br/><br/>2. Verify if the issue is related to WebKit WebView cookies management. <br/><br/>3. Ensure that the cookie settings are in line with the recommendations in the Microsoft Teams platform documentation. <br/><br/>4. If the issue persists, escalate it using the provided link.
**Code**: 53001 <br><br>**Message**: The error message is about incompatible browsers and authentication failure of a custom Teams app due to Conditional Access policy. | A developer tries to authenticate a custom Teams app for a customer who has a Conditional Access policy that restricts browsers. The user is presented with a 53001 error and a message about incompatible browsers. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/8476) | Ensure that the customer is using a domain joined device as the Conditional Access policy requires it. If the device isn't domain joined, it gives a 53001 error. If the issue persists, check the browser compatibility and update the browser details in the Teams app.
**Code**: CORS <br><br>**Message**: Access to XMLHttpRequest at '<https://login.microsoftonline.com/common/oauth2/v2.0/token>' from origin is blocked by CORS policy. | A developer tries to enable SSO for a Teams App and is using client-side code to acquire a token using Microsoft Authentication Library(MSAL). The token API is failing due to a CORS issue in both local and development environments. <br><br> **Source:** [View](https://stackoverflow.com/questions/74426827/cors-issue-while-trying-to-access-https-login-microsoftonline-com-common-oauth) | The `OnBehalfOf(OBO)` token call should only be made from a backend server, where CORS wouldn't apply. The only call that needs to be made from the front-end code is `microsoftTeams.authentication.getAuthToken()`. Review the linked video and blog post for a more detailed understanding.
**Code**: SDK initialization timed out <br><br>**Message**: The error message indicates that the SDK initialization is timing out when trying to authenticate with Adobe ID in a Teams app. | A developer tries to implement simple authentication in a Microsoft Teams app using Adobe ID as a third-party OAuth provider. However, an exception is thrown when the `app.initialize()` function is called, stating that the SDK initialization is timed out. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/694) | Confirm the SDK version and Microsoft Teams version being used. Try using `microsoftTeams.app.initialize().then(() =>)`to see if it resolves the issue. If the problem persists, check if the sample works with **@microsoft/teams-js 2.7.1** and **Microsoft Teams Version 1.6.00.2979** as these versions are confirmed to work without throwing any exceptions or errors.

## Bots

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Bad Request - Error in query syntax <br><br>**Message**: The error occurred while trying to get detailed user information using `GetUserProfile()` in Microsoft Power Virtual Agents Flow Template. | Developer attempted to fetch detailed user information using Microsoft Power Virtual Agents in Microsoft Teams. The error surfaced when using `GetUserProfile()` function with the input as `first(outputs('Search_for_users_(V2)')?['body/value'])?['UserPrincipalName']`. <br><br> **Source:** [View](https://stackoverflow.com/questions/74814903/microsoft-power-virtual-agents-error-in-power-virtual-agents-flow-template) | Use `UserID` instead of display name, eliminating the need for the call to `SearchForUsers()`. Correcting the input to `GetUserProfile()` function should resolve the issue.
**Code**: ServiceError <br><br>**Message**: Couldn't find Connection Setting with name teamsAuth. | Developer attempted to add SSO for a notification bot using Teams Toolkit. Even after following the documentation and adding the OAuth connection in the bot, an error stating that the connection setting teamsAuth couldn't be found was encountered. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7407) | Verify that the OAuth connection name is correctly added to the .env file as mentioned in the documentation. If the issue persists, try using the `TeamsBotSSOPrompt` function by registering a Microsoft Entra app for bot authentication. If the problem still persists, consider filing an issue in the TeamsFx repo for further assistance.
**Code**: Not available <br><br>**Message**: Unknown attachment type. | Developer attempted to attach a PDF file to a Microsoft Teams bot and encountered an error. <br><br> **Source:** [View](https://stackoverflow.com/questions/74885946/attached-pdf-to-ms-teams-chatbot) | Check the sample code for file sharing on Microsoft Teams provided by Microsoft. Additionally, enable the `supportsFiles` option in the app manifest for the bot to support file attachments.
**Code**: Not available <br><br>**Message**: Failed to decrypt pairwise ID.| An error occurred when trying to create a conversation between a bot and a user in Teams using the POST request to the `https://smba.trafficmanager.net/amer/v3/conversations`endpoint. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7424) |Verify the values of each parameter in the request, especially the ID given for the member parameter. If the error persists, try executing the request at a different time as it may be a temporary issue.
**Code**: Not available <br><br>**Message**: The deep link doesn't save the `subEntityId` param when clicked in Microsoft Teams chat. |Developer attempted to use a deep link in Microsoft Teams chat, but the `subEntityId`     parameter isn't saved when the link is clicked. <br><br> **Source:** [View](https://stackoverflow.com/questions/74349950/microsoft-teams-deep-link-from-chat) | Ensure that the 'context' isn't web encoded. Use the following format: `https://teams.microsoft.com/l/entity/c38259cb-cd15-4797-b634-098bcea43f9a/index1?webUrl=https://google.com/&label=Google&context={"subEntityId":39138959}`
**Code**: 412 <br><br>**Message**: The server crashes when attempting to send a 412 response in the `onInvokeActivity` in the `server/bots/botActivityHandler.js`. | A developer using Node 16 and npm 8 in the sample app-sso experiences a server crash when the `botAdaptivity` tries to return a 412 response. The bot-builder doesn't catch and process this exception, leading to the app crash. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/513) | Ensure that all required permissions are added and the configuration is correct. Check if admin consent is granted for the graph APIs. Consider adding exception handling in the server or elsewhere to catch and process this exception. <br>An issue is submitted to botbuilder-js and this problem is added to the backlog.
**Code**: invalid_grant. <br><br>**Message**: Due to a configuration change made by your administrator, or because you moved to a new location, you should use multifactor authentication to access. | Developer is trying to create Microsoft Teams chatbot using Python and is having difficulty obtaining the correct access token to read the user's group chat and interact with it. The user has multifactor authentication enabled. <br><br> **Source:** [View](https://stackoverflow.com/questions/75780492/python-ms-teams-chat-bot) | The developer needs to use interactive flows where user sign in is required. The developer needs to modify the code to use `acquire_token_interactive` instead of `acquire_token_by_username_password`. Also, add a redirect URI as `https://localhost` in the application.
**Code**: Not available <br><br>**Message**: Manifest.json validation errors and meeting join events not getting delivered. | Developer is attempting to run a Microsoft Teams bot for meeting events but is encountering validation errors with the manifest.json file. Additionally, the bot isn't receiving meeting join events, although chat messages are being received. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/378) | Follow these steps: <br/><br/>1. Ensure that the manifest.json file is correctly formatted and adheres to the schema. <br/><br/>2. Check the bot's permissions and scopes to ensure it has the necessary access to receive meeting join events. <br/><br/>3. For guidance refer to the [sample](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/meetings-events/csharp) provided by Microsoft. <br/><br/>4. If the issue persists, reach out to Microsoft support for further assistance.
**Code**: Not available <br><br>**Message**: This action can't be performed since the app doesn't exist or is uninstalled. | Developer is creating a Microsoft Teams messaging bot that requires authentication or sign-in. The bot sends a nonreply message to the user that includes a hero card with a sign-in button. When the user receives the hero card and clicks the sign-in button, an error message is displayed. <br><br> **Source:** [View](https://stackoverflow.com/questions/73364222/ms-teams-bot-sign-in-not-working-says-this-action-cant-be-performed-since-the) | Follow these steps: <br/><br/>1. Ensure that token.botframework.com and login.microsoftonline.com are added in the valid domain section of app manifest. <br/><br/>2. If the user is uploading a custom app, installing or uninstalling the app might be problematic. Try closing and reopening Microsoft Teams client.
**Code**: Error finding key for token <br><br>**Message**: The system can't locate the key for the token during the command bot app test. | While testing a command bot app in Microsoft Teams, the developer used @mention to send a helloWorld command to the bot. However, the bot didn't respond, and an error message **Error finding key for token** appeared in the Visual Studio Code terminal. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/8083) | 1. Verify that the bot configuration is correct and the token is properly generated. <br/><br/>2. Confirm that the RSA public key is correctly set up and matches the token. <br/><br/>3. Ensure to follow all prerequisites and steps as per the provided document. <br/><br/>4. Attempt to reproduce the issue in a different environment or setup to identify the problem. <br/><br/>5. If the issue continues, consider contacting the Microsoft Teams Developer Community or escalating the issue using the provided link.
**Code**: 400 <br><br>**Message**: Bot doesn't respond when using the app service URL as the messaging endpoint. | Developer is attempting to use a bot with a deployed service URL in Microsoft Teams. The bot operates correctly with ngrok but doesn't respond when using the app service URL. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7047) | Check if a policy is preventing the request from Teams to the app service. If so, adjust the policy to permit the request. Ensure that the domain where the app is deployed is listed under the validDomains section of the manifest. If SSO isn't, input a dummy string value in the resource field of the webApplicationInfo section of the app manifest.
**Code**: DEP0005, DEP0018 <br><br>**Message**: The bot stopped responding due to Buffer() deprecation and unhandled promise rejections. | A bot, built with Microsoft Bot Framework Node.JS SDK and deployed on a windows server, stopped responding after functioning correctly for over a year. <br><br> **Source:** [View](https://stackoverflow.com/questions/73157955/azure-bot-is-not-responding-on-teams) | Replace the deprecated `Buffer()` methods with the updated `Buffer.alloc()`, `Buffer.allocUnsafe()`, or `Buffer.from()` methods in the code. Also, handle promise rejections correctly in the code to prevent the Node.js process from terminating.
**Code**: Invalid URL <br><br>**Message**: Invoking a Teams chat via deep link to external contacts doesn't function on iOS. | The developer is attempting to invoke a Teams chat with external contacts using deep l    ink on iOS. The operation works correctly on other platforms such as desktop but fails on iOS, returning an 'Invalid URL' error. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1502) | Confirm that the URL used to invoke the chat is correctly formatted and valid. Test the URL on various platforms to verify its functionality. If the issue continues, escalate it using the provided link in the Microsoft Teams Developer Community.
**Code**: Not available <br><br>**Message**: Even after having the ChannelMessage.Read.Group RSC permission, the bot isn't receiving all channel messages. | The developer is trying to configure a bot to receive all channel messages, even when not mentioned, as per the documentation. However, the bot isn't receiving all messages unless explicitly mentioned. The developer is also encountering issues with the `webApplicationInfo` structure in Manifest.json and receiving an error when uploading the manifest.json. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6771) | Follow these steps: <br/><br/>1. Confirm that the manifest version is v1.12 or higher. <br/><br/>2. Add `token.botframework.com` to valid domains. <br/><br/>3. Remove `orgWide: []`, from the authorization section. <br/><br/>4. Provide the bot-id in the `webapplicationInfo` section. <br/><br/>5. See the sample provided in the link and follow the steps: <https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/bot-receive-channel-messages-withRSC/csharp>.
**Code**: BotNotInConversationRoster <br><br>**Message**: The bot's automatic installation from a message extension isn't functioning. | The developer is attempting to install a bot automatically from a message extension. Even after adhering to the documentation and utilizing an Adaptive Card with an install button, the bot fails to install. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/582) | Follow these steps: <br/><br/>1. Confirm that the bot is properly set up in the manifest.json file. <br/><br/>2. Inspect the messaging extensions invoke handler in TeamsBot. <br/><br/>3. Ensure the Adaptive Card is correctly formatted and includes the `justInTimeInstall` property. <br/><br/>4. Consider uploading the app through the Teams admin center instead of uploading a custom app. <br/><br/>5. Test the setup with a different sample to see if the problem continues.
**Code**: Permissions Denied <br><br>**Message**: Permission denied. Request your IT admin to add this app for you. | The developer is attempting to install a bot in Microsoft Teams but encounters a 'Permission Denied' error. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/780) | Follow these steps: <br/><br/>1. Confirm that the bot is properly configured and approved for use in your organization. <br/><br/>2. Check if the bot requires any specific permissions that aren't granted. <br/><br/>3. If you're an IT admin, ensure that the bot is added to the app catalog and approved for use. <br/><br/>4. If you're not an IT admin, ask your IT admin to add the bot for you.
**Code**: Invalid user identity in provided tenant <br><br>**Message**: The bot encountered an error while sending Adaptive Cards to users outside the host's tenant or organization. | The developer is attempting to send an Adaptive Card to each member of a meeting using a notification bot. The bot successfully sends the card to the meeting creator but encounters an error when trying to send to other members. <br><br> **Source:** [View](https://stackoverflow.com/questions/73114932/invalid-user-identity-in-provided-tenant-when-sending-adaptive-card-to-other-m) | The bot can only send Adaptive Cards to users within the host's tenant or organization. Implement a condition to verify if the member's tenantId matches the conversation's tenantId before sending the Adaptive Card. The action prevents the bot from trying to send cards to users outside the host's tenant, thus avoiding the error.
**Code**: Not available <br><br>**Message**: The bot doesn't respond to command messages in a Teams channel without an assigned owner. | The issue arises when a command message is posted in a Teams channel that was created using the Graph API and doesn't have an assigned owner. The bot installed in the channel doesn't respond to the command message. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7527) | Ensure that the Teams channel has an assigned owner. Review the channel's settings for owner assignment. If the problem persists, it might be due to an intermittent issue with the Graph API. Monitor the situation and report if the issue reoccurs.
**Code**: `context.adapter.getSignInLink` isn't a function. <br><br>**Message**: The function `getSignInLink` isn't recognized as a function of `context.adapter`.| The developer is following a tutorial to implement Adaptive Cards in a Microsoft Teams bot. The error arises when trying to use the `getSignInLink` function with the `CloudAdapter` class, which isn't recognized as a valid function. <br><br> **Source:** [View](https://github.com/OfficeDev/Microsoft-Teams-Samples/issues/722) | The user should see the provided NodeJS sample where the `CloudAdapter` class is used. If the problem persists, the user should ensure to use the latest version of the repository and seek other examples or documentation on how to use the `getSignInLink` function with the `CloudAdapter` class.
**Code**: 401 <br><br>**Message**: Unauthorized Error ngrok. | A developer setting up a bot for the C# Sequential Flow Adaptive Card encounters a 401 Unauthorized Error while testing a sample incident. <br><br>  **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/738) | Verify the messaging endpoint URL in bot registration is correctly set to `https://<your_ngrok_url>/api/messages`. If the problem continues, consider reregistering the Microsoft Entra app, recreating the bot, and switching the settings from single tenant to multitenant.
**Code**: Invalid client secret provided <br><br>**Message**: The client secret provided in the `GetAuthenticationToken()` method is invalid. The secret sent in the request should be the client secret value, not the client secret ID. | A developer running a bot encounters an error in the `GetAuthenticationToken()` method due to an invalid client secret. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/749) | Ensure the client secret value, not the client secret ID, is used. If the problem continues, consider creating a new client secret.
**Code**: Ext.SetUpBotError <br><br>**Message**: Failed to create an app in Azure Active Directory. | A developer setting up an interactive bot using the sbs-gs-notificationbot.yml file encounters a failure at the step of registering the Microsoft Entra app, which is necessary for creating the bot. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/8470) | Follow these steps: <br/><br/>1. Verify the required permissions to create an app in Microsoft Entra ID. <br/><br/>2. Review the Microsoft Entra ID's setup and configuration. <br/><br/>3. Follow the steps in the 'Set up bot' task documentation at <https://aka.ms/teamsfx-debug-set-up-bot-task.> <br/><br/>4. If the problem continues, escalate the issue using the link <https://aka.ms/DevCommunityEscalationForm>.
**Code**: Not available <br><br>**Message**: Bot isn't receiving all channel messages even after having the ChannelMessage.Read.Group RSC permission. | A developer trying to receive all channel messages through a bot, which should receive all messages even when not mentioned according to the ChannelMessage.Read.Group RSC permission, finds that the bot isn't receiving all messages unless explicitly mentioned. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6397) | Ensure the bot is in Public Developer Preview as this feature is only available in this mode. If the problem continues, test the bot using the sample provided at <https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/bot-receive-channel-messages-withRSC/csharp>. If the issue still exists, provide a screen recording of the issue for further investigation.
**Code**: BadRequest <br><br>**Message**: The user 'XXX-XXX-XXX-XXX-XXX' isn't found. | A developer trying to assign a phone number to a bot using PowerShell encounters an error when attempting to assign the number to the bot. <br><br> **Source:** [View](https://stackoverflow.com/questions/73571927/assgin-phone-number-to-teams-bot) | Follow these steps: <br/><br/>1. Create the application instance without application ID. <br/><br/>2. Assign the number. <br/><br/>3. Assign the application ID to the application instance. Microsoft is working on a solution for this issue.
**Code**: 401 <br><br>**Message**: Unauthorized access error. All bot interactions are failing with 401 or failing to reach the local server completely. | The developer followed the setup instructions for the `app-complete-auth` NodeJS example. However, all bot interactions are failing with a 401 error or failing to reach the local server. The bot registration is configured as **UserAssignedMSI** and the developer is using an unpaid ngrok account. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/670) | Review the ngrok configuration and ensure to set up correctly. Also, check the bot registration settings. The bot should be configured as multitenant, not **UserAssignedMSI.** Use the existing app registration option to create the bot using the app registration ID created in the first chapter of the setup instructions.
**Code**: 0 <br><br>**Message**: Unknown bot. | The developer is attempting to use a contentBotId from a different tenant in the Microsoft Teams manifest file. When the contentBotId is from the same tenant as the Microsoft Teams domain, it works and loads the data. However, when the contentBotId is from a different tenant, Microsoft Teams doesn't load anything. <br><br> **Source:** [View](https://stackoverflow.com/questions/73759099/microsoft-teams-manifest-can-contentbotid-be-of-different-tenant) | Create a multitenant bot using ML Studio before creating the MS bot. Register the application and check the manifest file for the required ContentBotId. Test the URL after app registration into multitenant. If the error still occurs, set up the connection settings under configurations. Add Oauth connection settings to get some kind of authentication for different clients for the same authentication URL. If the issue persists, it might be due to the use of existing Microsoft Entra ID instead of creating from Azure bot template. The manually created Microsoft Entra ID has email address of user who's created this in Owners section, while Microsoft Entra ID created from Azure bot template has `Bot Framework Dev Portal` user.
**Code**: AADSTS700016 <br><br>**Message**: Application with identifier 'Application (client) ID' wasn't found in the directory 'Bot Framework.' | The developer was attempting to run a proactive installation sample app using the client ID from Azure bot configuration. The error occurred when the application wasn't found in the directory Bot Framework. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/672) | Verify if the correct client or app ID is being used. Ensure that the bot is set up through the CLI and not through the web interface. Confirm if the required Microsoft graph Application-level permissions `TeamsAppInstallation.ReadWriteForUser.All` are added. Follow these steps to add proper IDs and secret details in the 'appsettings.json' file. Upload the app at the org level to get `AppCatalogTeamAppId` and then try to add the app in either personal or team scope. If the error persists, retry the steps by following the guidelines step by step creating a new app ID.
**Code**: 401 <br><br>**Message**: UserNotAuthorized ToGrantResourceSpecificPermission error is received when trying to add bot to a meeting. | The developer implemented a 'Meeting-Attendance-bot' in Azure and tried to add it to a meeting. Even after granting Graph API permissions for the tenant, the bot couldn't be added due to a UserNotAuthorizedToGrantResourceSpecificPermission error. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/686) | Ensure that the required permissions are granted and access is allowed. See the documentation on granting Resource Specific Consent (RSC) permissions. Confirm if the correct sample is being used. Ensure to allow applications to access online meetings on behalf of a user. Check the application access policy setup using PowerShell. Create an application access policy and grant the policy to the user to allow the app ID contained in the policy to access online meetings on behalf of the granted user.
**Code**: 403 <br><br>**Message**: CSRF token validation failed. | The error occurs when trying to trigger a PATCH request via HTTP AZURE Gateway from Power Virtual Agent BOT to S/4 HANA through OData v2 service. The CSRF token is fetched and stored in a local variable and passed to PATCH request. The error is seen in Power Automate Flow. <br><br> **Source:** [View](https://stackoverflow.com/questions/74356412/csrf-token-validation-failed-error-while-triggering-a-patch-request-from-microso) | The issue is with the Microsoft on-premise-gateway, which is used to connect the OData service. The on-premise-gateway always establishes a new HTTP connection that expires the X-CSRF-TOKEN. Wait for a version that supports this action or try a different method to connect the OData service.
**Code**: Not available <br><br>**Message**: Azure Teams Bot stops responding after a few minutes of operation in Teams. | A bot developed for Teams using Azure Bot Service and C# works well in local environment using Bot Framework Emulator, but stops responding after some time in Teams. Uninstalling and reinstalling the bot temporarily resolves the issue but it reoccurs. <br><br> **Source:** [View](https://stackoverflow.com/questions/74546756/azure-teams-bot-not-responding-after-a-few-minuets) | Downgrade the .NET version and SDK version to 3.14. Implement a `BotJwtRefreshWorker` class that refreshes the bot's token every 30 minutes. This action ensures that the bot always has a valid token and reduces or eliminates the waiting time.
**Code**: Bad Request - Error in query syntax <br><br>**Message**: Error in the `GetUserProfile` query syntax in Power Virtual Agents Flow Template. | The developer is attempting to get detailed user information using Microsoft Virtual Agent in Microsoft Teams. The error occurs when the developer tries to get the user's email by calling `SearchForUsers()` and then `GetUserProfile()`. <br><br> **Source:** [View](https://stackoverflow.com/questions/74814903/microsoft-power-virtual-agents-error-in-power-virtual-agents-flow-template) | Instead of passing in display name, pass in `UserID`. This action eliminates the need for the call to `SearchForUsers()`.
**Code**: ProvisionError <br><br>**Message**: Failed to provision Developer Portal bot registration. | The error occurred while trying to debug a sample bot project locally using TeamsFx-Samples or share-now. The error was thrown during the set-up-bot task, specifically at the step of Registering the bot in `Bot Framework Portal.`<br><br> **Source:** [View](https://stackoverflow.com/questions/74758147/provisionerror-failed-to-provision-developer-portal-bot-registration-pops-up-wh) | The issue was related to a server-side API issue, which is resolved. Verify the local debug experience of Teams Toolkit (TTK) to ensure it's working properly now. Stay updated with the issue on the provided GitHub link for any further updates.

## Cards

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: iOS Teams app not showing card if the card contains a hyperlink with an ampersand. | A developer attempts to display a card in the iOS Teams app, which includes a hyperlink with an ampersand. However, the app only displays the message **Sent a card.** <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7170) | Verify that both the iOS and Teams versions are current. If the problem continues, provide the card JSON for further examination. The issue might be related to how the hyperlink is parsed when it includes an ampersand. As a temporary solution, consider encoding the ampersand in the URL.

## Developer Portal

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Manifest Error <br><br>**Message**: Manifest is invalid due to missing `name.short` and `name.full` properties in the localization file. | A developer tried to upload a Teams app manifest with localization, but an error occurred due to missing `name.short` and `name.full` properties in the localization file. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7551) | Include `name.short` and `name.full` properties in the localization file. These fields are mandatory even if the application name isn't localizable.
**Code**: File not found <br><br>**Message**: The file couldn't be found in the app package. | A developer attempted to import the 'Hello World' app package to the Developer Portal in Microsoft Teams, but the import failed due to a missing file in the app package. The error persisted even after generating the app package using the 'gulp' command and manually creating the app package. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/510) | Update the color and outline icon file names in the manifest file manually. If the issue persists, create a zip package manually that includes the color, outline, and manifest file, which is in the appPackage folder. If the issue still persists, check **PR #525** for the updated changes.
**Code**: Error converting value **{{variable-name}}** to type `System.Nullable1[System.Guid]. Path 'botId,` line 1, position 31. <br><br>**Message**: Can't use environment variable as Bot ID in Teams App Developer Portal. | A developer tried to use an environment variable as a bot ID while creating a Teams app manifest using the Developer Portal. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/5011) | Don't use environment variables in the GUID field. Instead, use the GUID value directly in the bot ID field.
**Code**: 400 <br><br>**Message**: App failed to update. | A developer attempted to update a bot in the Developer Portal but forgot to identify the bot by selecting an existing bot in the dropdown. An error occurred when trying to save the changes. <br><br> **Source:** [View](https://stackoverflow.com/questions/73298450/how-to-fix-app-failed-to-update-error-in-developer-portal) | Delete the existing instances and repeat the process. The Developer Portal creates a unique app ID and locks the ID for the registered Teams app, preventing duplicate app IDs for multiple apps. The app manifest didn't update with the commands because the existing bot wasn't selected, causing the error.
**Code**: Not available <br><br>**Message**: Option to disable developer previews no longer exists in the stated menu. | A user enabled the developer preview in Microsoft Teams and later found that the option to disable it no longer exists in the menu. The user was unable to disable the developer preview for a year. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7171) | Update the Teams version and check again. If the issue persists, connect with the tenant admin to disable the policy. If the issue still persists, reach out to [Microsoft 365 Product Support](https://support.microsoft.com/en-us/microsoft-365).
**Code**: 514 <br><br>**Message**: SDK Initialization Failed - Provide instrumentation key. | A developer tried to initialize the Teams SDK in web teams on Chrome browser but it failed due to a missing instrumentation key. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1453) | Provide a valid instrumentation key while initializing the SDK. The instrumentation key is required for telemetry data. If it isn't there, create one in the Azure portal.
**Code**: Duplicate file error <br><br>**Message**: Duplicate readme.md files found in different sample paths. | Duplicate readme.md files were found under different parent sample paths while ingesting sample files. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/568) | Review the files and delete the duplicates if they're not needed. A PR is raised to delete the second readme file residing in the Images or path. After the changes are pushed to the main branch, confirm the changes.
**Code**: SyntaxError <br><br>**Message**: Can't use import statement outside a module. | A developer tried to run the Microsoft Teams sample app `app-hello-world` locally using npm start, but encountered a syntax error related to the import statement. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/446) | Add "type": "module," in the package.json file. If the issue persists, follow the steps mentioned in the `app-hello-world` GitHub sample and see the **Common Issues** section.
**Code**: Not available <br><br>**Message**: Provided add-in package wasn't understood. Ensure that the file being submitted is a valid Office add-in package. | An error occurred while importing an AppStudio app in the Developer Portal in Teams. <br><br> **Source:** [View](https://stackoverflow.com/questions/73895355/error-while-importing-appstudio-app-in-developer-portal-in-teams) | Follow these steps: <br/><br/>1. Ensure that the Manifest Version is provided in $schema and manifestVersion. <br/><br/>2. Avoid using reserved IDs **about** and **conversations** for entity ID in the manifest. Also, don't specify the `Name` property for reserved IDs. <br/><br/>3. Either provide a value for property `defaultGroupCapability.meetings` or remove.
**Code**: Package Loading Failure <br><br>**Message**: Provided add-in package wasn't understood. Ensure that the file being submitted is a valid Office add-in package. | An error occurred while trying to import an existing app to the developer portal. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6743) | Create a zip folder that doesn't contain any subfolders. Select the manifest.json, color.png, outline.png and create a zip folder directly. If the issue persists, share the zip folder with the support team for further investigation.
**Code**: Error while reading manifest.json: root <br>Required properties are missing from object: [`description.short`,`description.full`. <br><br>**Message**: Manifest parsing failed due to missing required properties in the manifest.json file. | A developer tried to upload manifest files for a team extension-based commercial application on Microsoft Teams. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7593) | Check the manifest.json file for missing required properties. In this case, `description.short` and `description.full` were missing. Update the file with the required attributes and reupload the manifest zip from Teams app > Manage apps.
**Code**: Uncaught SyntaxError: Invalid or unexpected token <br><br>**Message**: An unexpected syntax error occurred while trying to build the React template. | A developer followed the instructions to build a React template for a Teams app. Upon building, an unexpected syntax error occurred, even though no changes were made to the code. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6424) | Follow these steps: <br/><br/>1. Ensure that the Teams client is updated to the latest version. <br/><br/>2. Check the code for any syntax errors, even if no changes were made. <br/><br/>3. Try to rebuild the app. <br/><br/>4. If the error persists, consider using Teams SDK 2.0 and making necessary changes to the Manifest file. <br/><br/>5. Ensure that the domain of the website is added to the validDomain list in the manifest.
**Code**: TypeError <br><br>**Message**: Can't set property closed of # which has only a getter. | An error occurred when a developer tried to set up the `app-hello-world` nodejs sample using a newer version of node. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/587) | Downgrade the node version to a compatible one. Alternatively, check for updates or fixes in the restify library that support the newer version of node.
**Code**: Mgmt.AppCatalog.LOBApp.Upload.BadRequest.Error <br><br>**Message**: Error occurred while adding app manifest to Microsoft Teams admin center. | A developer tried to add an app manifest to Microsoft Teams admin center but encountered an error. <br><br> **Source:** [View](https://stackoverflow.com/questions/76821663/error-adding-app-manifest-to-teams-admin-center) | Follow these steps: <br/><br/>1. Update the app manifest version to a newer one. <br/><br/>2. Ensure app manifest ID and Bot ID aren't the same. The Bot ID should be the Azure Application ID for the Bot itself, which is available in Azure's Bot registration. <br/><br/>3. Review the validdomain entries. They're not typically needed for a bot and are mostly needed for other app types like a Tab app.

## Device capabilities

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Unable to launch camera in android mobile using the provided React-js code snippet. | A developer attempts to launch the camera and gallery on both Android and iPhone using a React-js code snippet in a Microsoft Teams app. The camera doesn't open on Android, only the gallery opens without multiple selections, while it works fine on iPhone. <br><br> **Source:** [View](https://stackoverflow.com/questions/74561993/unable-to-launch-camera-in-android-mobile)| Verify that the necessary camera and storage permissions are granted on the Android device. Inspect the app's permission settings and ensure the camera and storage permissions are enabled. If the issue continues, debug the code to identify any potential issues specific to Android.
**Code**: 10000 / SIZE_EXCEEDED <br><br>**Message**: The error occurs when users select more than a certain number of images using the `microsoftTeams.media.selectMedia` function, exceeding the total file size limit of ~30 MB. | The problem occurs when users of the custom message extension, especially on modern Android devices, select more than five images at once. Each image can be over 6 MB, causing the function to fail due to the total file size limit. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1317) | The platform's size boundaries appear to be limited. Adjust the **maxMediaCount** value as mentioned in the code. However, the exact limit might vary depending on the device and the size of the images. The Microsoft team is exploring ways to address the platform size limit.
**Code**: DOMException: Permission denied <br><br>**Message**: Unable to get audio record in meeting side panel. | The developer attempts to get audio record in the meeting side panel using TeamsFx-Samples and Recorder.js. The code works in `meetingChatTab` but fails in meetingSidePanel, with no console error but a DOMException: Permission denied in `meetingChatTab` (web version). <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/442) | The user should ensure to grant permission at a per app level in the web browser as per the instructions in the Microsoft Teams documentation. However, note that device permissions in the meetings side panel aren't yet supported in the General or Public ring.

## Message extension

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Error encountered while running the msgext-search bot sample, with issues in bot registration and GraphQL resolver error with the `searchMessageExtension` field path. | The developer executed the msgext-search bot sample in a development environment using Node.js 16 and the latest version of Chrome. The console log displayed errors, indicating issues with bot registration and a GraphQL resolver error. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-samples/issues/719) | Verify that the bot registration is properly configured. Follow the steps outlined in the Microsoft Teams documentation to set up a messaging extension search command. Additionally, inspect the GraphQL resolver for the `searchMessageExtension` field path for any errors and rectify them. If the issue continues, it might be a sporadic problem and should be reported for further investigation.

## Microsoft Graph

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: PreconditionFailed <br><br>**Message**: PreconditionFailed-ETag mismatch for thread store resource. | Error while creating a group chat using the $batch API from MS Team Graph API. <br><br> **Source:** [View](https://stackoverflow.com/questions/75531923/ms-teams-graph-api-preconditionfailed-etag-mismatch-for-thread-store-resource-w) | Use the correct POST query to create the group chat. After creation, add members to the chat using batch operation.
**Code**: No authorization information present <br><br>**Message**: No authorization information present on the request. | Error while calling a Graph API from the explorer even after having all required permissions. <br><br> **Source:** [View](https://stackoverflow.com/questions/75345649/why-i-am-getting-no-authorization-information-present-on-the-request-from-gra) | Verify that an admin has granted the necessary permissions. Decode the token at <https://jwt.ms/> and check if the required permissions are in scope.
**Code**: PowerShell>TerminatingError(Import-Module) <br><br>**Message**: Couldn't load file or assembly 'System.Management.Automation, Version=7.2.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system can't find the file specified. | Error when executing a PowerShell script via Intune on devices other than the developer's own. The script is for deploying corporate images to each user's workstation for use as Microsoft Teams backgrounds. <br><br> **Source:** [View](https://stackoverflow.com/questions/75924599/powershell-script-isfailing-when-executing-from-intune) | Follow these steps: <br/><br/>1. Downgrade the PnP PowerShell to version 1.12.0. <br/><br/>2. If running in an Azure DevOps release pipeline, force the PowerShell task to run with PowerShell Core. <br/><br/>3. If running via Intune, check if there is an option to enforce using PowerShell Core. <br/><br/>4. Alternatively, host the image files on an accessible website and use 'Invoke-WebRequest' to remove the need for interaction with PnP.PowerShell.
**Code**: Forbidden <br><br>**Message**: UnknownError. | Error while trying to retrieve messages from a public Microsoft Teams channel that the developer isn't a part of, using Microsoft Graph APIs. <br><br> **Source:** [View](https://stackoverflow.com/questions/72811357/get-microsoft-teams-public-channel-message) | Ensure the access token has at least ChannelMessage.Read.All permission. Check the functionality in the Graph Explorer. Only team members, owners, or admins can access GET /teams/team-id/ and even admins can't pull messages from channels they're not part of.
**Code**: Not Applicable <br><br>**Message**: Batch request against /education/user/{userId} endpoint in Microsoft Graph API isn't returning a `value` property. | Error while running a batch request against the /education/user/ endpoint in Microsoft Graph API and not receiving a `value` property in the response. <br><br> **Source:** [View](https://stackoverflow.com/questions/73894073/microsoft-graph-education-user-batch-request-not-returning-a-value-property) | This is a feature of the Microsoft Graph API. When calling endpoints that return a single object, like /education/users/, the batch response directly contains the object. No `value` property is returned.
**Code**: Not Applicable <br><br>**Message**: The 'Get-Team' command in the PowerShell script isn't returning any results. | A developer is trying to write a PowerShell script to display all teams in Microsoft Teams software, but the 'Get-Team' command in the script isn't showing any output. <br><br> **Source:** [View](https://stackoverflow.com/questions/73484825/how-to-get-command-output-in-the-powerShell-script) | Ensure the 'Get-Team' cmdlet is used with the correct parameters. For more information, see [examples](/powershell/module/teams/get-team).
**Code**: 403 <br><br>**Message**: You don't have the required permissions to access this item. | Error while trying to list tasks for a plan using MS Graph API in a Teams app. The error occurs when a user without admin privileges tries to access the tasks. <br><br> **Source:** [View](https://stackoverflow.com/questions/74340075/ms-graph-api-missing-permissions) | Ensure the user has the necessary permissions to access the tasks. The required permissions are either Tasks. Read, Tasks.ReadWrite, Group.Read.All, or Group.ReadWrite.All. The user should also be a member of the group that the plan belongs to. Test the API using Graph Explorer against your own tenant.
**Code**: PreconditionFailed <br><br>**Message**: Failed to execute TeamsGraphService backend request RevokeGroupResourceSpecificPermissionsRequest. | Error while trying to remove a side-loaded application from a Team installation using the Graph API. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/7550) | Ensure the Teams app doesn't have Resource-Specific Consent (RSC) permissions. Installation or removal of apps with RSC permissions isn't supported in app-only context. If the app needs to read members of a Team and direct message users in a Team, RSC permissions aren't required. Use the bot API to get members of a Team and send 1:1 personal chat messages in Teams.

## Tabs

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Admin Permissions Consent window doesn't close back after granting or canceling permissions in the desktop or Mac Teams app. | A developer is building a Microsoft Teams Tab application that requires opening the admin permissions consent page within the app. The consent window works fine on the web version of the application, but on the desktop or Mac Teams app, the window doesn't close after granting or canceling permissions. <br><br> **Source:** [View](https://stackoverflow.com/questions/73235113/ms-teams-tab-app-is-not-closing-back-the-admin-permissions-consent-window-in-the) | Follow these steps: <br/><br/>1. Don't mix Teams Tab SSO supports and the idea of having an admin do a preconsent in the same place. Provide a separate link for admin to preconsent or rely on the standard SSO experience. <br/><br/>2. Use `microsoftTeams.authentication.getAuthToken,` which handles SSO better than `authentication.authenticate.` <br/><br/>3. The redirect page should call the `notifySuccess(…)` method to close the sign in screen. <br/><br/>4. Mark the app as 'needs admin preapproval' and set 'defaultBlockUntilAdminAction' to 'true' and 'publisherDocsUrl' to the page with the instructions for the admin.
**Code**: VM5:2 <br><br>**Message**: Failed to execute 'postMessage' on 'DOMWindow': The target origin provided doesn't match the recipient window's origin. | The developer is trying to initialize a Teams application with a Tab that serves each tenant their own self-hosted version of the app. The initialization fails when trying to redirect to the tenant specific app. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1378) | Ensure that all possible domains are listed in the 'validDomains' field of the manifest. Also, experiment with the 'validMessageOrigins' option in `app.initialize()`. If the issue persists, check if there are any child windows or frames involved in the scenario.
**Code**: Not available <br><br>**Message**: getTabInstances API doesn't resolve in personal chat and on mobile. | The developer is trying to get Tab information for a personal chat using getTabInstances API, but it never resolves. The same behavior is observed on mobile as well. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1487) | The getTabInstances API isn't implemented on mobile and its performance is poor. Don't use it, as it gets deprecated. Instead, use the Graph APIs to know what tabs are pinned in a given chat or channel. The links to these APIs are [Add tab to chat](/graph/api/chat-post-tabs) and [List tabs in channel](/graph/api/channel-list-tabs). Using these APIs may require extra permissions on the app registration.
**Code**: 100 <br><br>**Message**: `registerBeforeUnloadHandler` doesn't work for mobile devices. | The developer is trying to use `registerBeforeUnloadHandler` and `registerOnLoadHandler` in a custom Teams app on mobile devices. The functions work well on web and desktop Teams but not on iOS and Android Teams. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1445) | There's no alternative to `registerBeforeUnloadHandler` for mobile devices and there are no plans to support it in the future. The user can suggest this feature in the Microsoft Teams Community.

## Task module

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Task module appears empty in Teams desktop or web app, but functions correctly in Teams mobile app. | A chat bot was developed to send Adaptive Cards with buttons that initiate Task modules. However, these Task modules appear empty when opened in Teams desktop or web app. This issue doesn't occur in the Teams mobile app. <br><br> **Source:** [View](https://stackoverflow.com/questions/72548540/task-module-empty-although) | Verify whether 'showLoadingIndicator' is set to true in app manifest. If it is, ensure to implement the corresponding protocol for displaying the loading indicator as per Microsoft's documentation. If the problem persists, debug the code to identify any potential issues with the Task module's implementation.
**Code**: X-Frame-Options set to 'deny' <br><br>**Message**: The application proxy doesn't work in Teams desktop task module due to login.microsoftonline.com authentication. | The developer is attempting to update an app to enable users to open their on-premises sites in the Teams task window using Microsoft Entra ID, Enterprise application, Application Proxy and assigned users. The app functions correctly on mobile and browser but fails on the desktop application with an error related to 'X-Frame-Options.' <br><br> **Source:** [View](https://stackoverflow.com/questions/73867078/application-proxy-doesnt-work-in-teams-desktop-task-module-due-to-login-microso) | Ensure the website used is iFramable and included in the valid domains of the Manifest. Set the Content-Security-Policy header to 'frame-ancestors teams.microsoft.com .teams.microsoft.com.skype.com.' For compatibility with Internet Explorer 11, set X-Content-Security-Policy. Alternatively, set the X-Frame-Options header to 'ALLOW-FROM <https://teams.microsoft.com/>.' See the documentation for tab requirements in Microsoft Teams.
**Code**: Not available <br><br>**Message**: Unable to load a different TeamsJS app inside of a task module/dialog. | The developer attempted to load another app inside of a different app's tab using a Task module in Microsoft Teams. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1301) | Loading a different TeamsJS app inside of a dialog isn't supported. The loading information and context is based on the manifest of the app that initiated the dialog. As an alternative, use Deep links instead of the `tasks.startTask` method.
**Code**: Not available <br><br>**Message**: Failed to load web view in Task module on Android. | The developer created an Adaptive Card containing an Image element that uses $data looping, each image is given a selectAction that sends a task or fetch activity and data payload. This functions correctly on web client and iOS, but not on Android. <br><br> **Source:** [View](https://github.com/officedev/microsoft-teams-library-js/issues/1582) |Follow these steps: <br/><br/>1. Verify whether the Android device is set up for remote debugging. <br/><br/>2. Ensure that the Virtual Device is in Developer Mode, enable USB and Wireless Debug options on Device in Developer Options, set Remote debug prompts to always allow, and enable Developer Preview on Teams app. <br/><br/>3. Test with different browsers to see if the debug option is appearing or not. <br/><br/>4. Configure the logs to debug the application.

## Upload a custom app

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Error while importing the Teams custom app after unzipping, zipping, and reimporting. |A developer attempts to import a Teams custom app. The import is successful when the zip is exported and immediately reimported. However, the import fails if the zip is exported, unzipped on a Mac or Windows computer, then rezipped and reimported. <br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6668) | When zipping the files, ensure to select only the three necessary files (manifest file, color and outline icon file) and zip them. Avoid zipping the entire folder containing these files as it results in the files being nested in a folder, which the dev portal doesn't anticipate.
**Code**: 403 <br><br>**Message**: Failed to create an app in Azure Active Directory due to insufficient privileges. | A user attempts to upload a custom app through Teams but encounters an error due to insufficient privileges. <br><br> **Source:** [View](https://stackoverflow.com/questions/76251639/getting-error-while-uploading-the-custom-app-in-teams) | Verify if the E3 license includes Microsoft Teams. Ensure the user has either the Application Administrator or Application Developer role assigned. If not, assign one of these roles to the user. There might be a delay after assigning the role, so try again after a while. If the error continues, sign in with a Microsoft 365 Developer Account. If you don’t have one, consider joining the Microsoft 365 Developer Program.

## Webhooks and connectors

|Error code + message|Scenario|Resolution
|--------------------|--------|----------
**Code**: Not available <br><br>**Message**: Error encountered when trying to mention @webhook name in teams. | A developer is attempting to invoke Azure functions from Outgoing webhooks in Microsoft Teams. The developer set up Outgoing webhooks in Teams and included the Azure function URL in the callback URL. Transferred the secret key from webhooks to Azure configuration. However, an error occurs when the user try to mention @webhook name in Teams. <br><br> **Source:** [View](https://stackoverflow.com/questions/74013191/ms-teams-invoking-azure-functions-from-outgoing-webhooks) | The developer must create an `HttpTrigger` Azure function, not just an `HttpRequest` function. See the provided code for creating an Azure `HttpTrigger` function. For more information on Azure functions and bindings, see the provided document.
**Code**: 403 <br><br>**Message**: Forbidden error when trying to do an HttpPOST request via a message card, delivered via a Custom Connector. | A developer is creating a custom connector for the application in Teams. The developer can post message cards using PostMan, but when attempting to post a message card with an Action (HttpPOST) and execute it by clicking a button, the individual receives a 'Failed to send' message. Further investigation shows that an API called Execute Action is returning a 403 forbidden error.<br><br> **Source:** [View](https://github.com/microsoftdocs/msteams-docs/issues/6739) | Verify the permissions for the webhook.site URL. Ensure to add as an Action URL in the connector developer dashboard and as a valid domain in the connector manifest.json. If the problem continues, consider using a different webhook.site as recommended by Microsoft Teams support.

[Back to top](#error-handling-messages)
