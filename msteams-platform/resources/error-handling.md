---
title: Error handling messages
description: In this article, display all the error handling messages for reference. 
ms.topic: reference
ms.localizationpriority: high
ms.author: v-vanisreeth
ms.date: 10/06/2023
---
# Error handling messages  

## Apps in meetings

|Error message                 |Scenario                                |Resolution |
|:-----------------------------|:---------------------------------------|:---------|
|No specific error code <br>**Reason**: Session ID changes every time the page is reloaded in the custom app on MS Teams Desktop App.|A custom app in Microsoft Teams Desktop App uses cookies and a session ID to keep track of temporary settings for tasks. The issue is session ID changes on every page reload.                                        |         |
|BadArgument <br>**Reason**: Unknown attachment type     |The developer is trying to attach a PDF file to a Microsoft Teams bot and encounters an error.        |Avoid using cookies in Teams apps as they can cause issues when switching between Desktop and Web or different devices. Instead, store state server-side in a database or other store, keyed on the user's AadObject ID (their unique Azure Active Directory user guid), which remains consistent across all platforms.|
|Upload failed File size too large <br>**Reason**: The file size limit for Adobe eSign feature is 10 MB.| The error occurred when trying to attach files over 10 MB using the Teams 'Approvals' App for eSignature and Approvals of documents.|Ensure that the file size doesn't exceed the limit set by Adobe eSign feature, which is 10 MB. If larger files need to be attached, consider compressing the files or using a different method to send them.|

[Back to top](#error-handling-messages)

## Adaptive card

|Error message           |Scenario                               |Resolution  |
|------------------------|---------------------------------------|------------|
|Unable to render dynamic data inside the AdaptiveCard template for user mentions in Teams.    | The developer is trying to create a dynamic AdaptiveCard to mention users in Teams. They're facing an issue with rendering dynamic data inside the template. They have tried to serialize a JSON with the same $data structure with the name of the user mentioned but it doesn't render anything.        |Currently, there's no support for sending a dynamic array to the entity property in Microsoft Teams. For mentioning a user, you need to repeat the entity block, not the text block. For more information, see [Adaptive Cards Template Language](/adaptive-cards/templating/language)|
|URL with double quotes in Adaptive Card action isn't opening in Microsoft Teams on iOS.|A developer is using Logic Apps to generate Actions in an Adaptive Card and pass a URL with double quotes. When the Adaptive Card is sent to Microsoft Teams and the action button is clicked, the URL doesn't open.|Verify the URL and try with a different URL. Ensure that the URL is properly encoded to handle special characters like double quotes. Test the behavior on different platforms (Teams web, desktop, and iOS) to isolate the issue. If the problem persists, report the issue with all the relevant details for further investigation.|
|Adaptive Cards aren't fully occupying width in MS Teams Group Channel despite setting the 'width: full' property.|The developer is trying to render Adaptive Cards in MS Teams Group Channel with full width. Despite setting the 'width: full' property, the Adaptive Card aren't occupying the full width.|The  engineering team fixed teh issue and rolled out the fix to the organization's tenant. The developer should ensure they're using the latest version of MS Teams Desktop and Web version in channel scope.|
|ReplyToId is coming null when user performs any action on the adaptive card in the emulator.|Developer is testing an adaptive card with yes/no action items in the emulator. When a user clicks on yes/no, the developer wants to update the card with a thank you message. However, the ReplyToId, which is needed for the update, is coming as null.|<br> 1. Verify the version of the Bot Framework Emulator being used. It's recommended to use version V4. <br> 2. Test the adaptive card again in the emulator. <br> 3. If the issue persists, share a screen recording of the issue for further investigation.|

[Back to top](#error-handling-messages)

## Authentication

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|403: disallowed_useragent  <br>**Reason**: 403 Google auth on Microsoft Teams mobile app returns |  The developer is trying to authenticate a Teams app using Google authentication on Android. The authentication process opens a popup but it redirects to an error page.|Ensure that the 'isExternal' parameter and two placeholder values in the existing url parameter are added to the authenticate() API to support external OAuth providers as suggested by Nivedipa-MSFT. If the issue persists, escalate it using the provided link.|
|Error Message:AuthFailed Failure to get the renewal token from microsoftTeams.authentication.getAuthToken({ }) on app load or for renewal when it expires.|The developer is trying to get the auth token for a personal app using microsoftTeams.authentication.getAuthToken({ }) method. The method is failing often and taking time to get the token. The token is only obtained on browser refresh/retry.|The developer is advised to set 'showLoadingIndicator' to 'false' and remove 'notifySuccess' and 'notifyFailure' calls to simplify the process. This setting is avoid confusion between SSO in a tab and the way the 'loading' indicator works.|
|getAuthToken() method returns empty SSO token in success callback.|The developer is trying to fetch the SSO token using TeamsFx React SDK in an SSO Tab app. The token is fetched successfully when running the app using Teams Toolkit or when previewing/publishing the app from the Developer Portal. However, when the app is deployed in Ring0, the SSO token is returned as an empty string.|Check the implementation of the getAuthToken() method. Ensure that the correct ClientId is being used across all environments. Verify the app manifest and app definition in Ring0. If the issue persists, escalate to the engineering team for further investigation.|
|Manifest Error Manifest doesn't contain the RSC permission to allow in-app purchases| The developer is trying to implement in-app purchases in Microsoft Teams app. The app works fine on a test tenant but shows an error on a normal tenant. The error also occurs on a second account where the in-app purchase popup doesn't appear. | <br> 1. Validate the manifest using Teams stores app validation in the Developer Portal. <br>  2. Follow the v1 implementation guide strictly, remove the planInfo parameter and put a callback function inside instead. <br>  3. Ensure that the in-app purchase is implemented in personal scope as it's currently not supported in channel scope.|
|unknownAuthError <br>**Reason**: The error occurs when the authentication.getAuthToken() function is called, returning Error: unknownAuthError.| The developer is trying to get tokens from the current user logged in on Teams Desktop App using the authentication.getAuthToken() function in the Teams SDK. The error occurs when testing on Teams Desktop client (both Windows and MacOS).|There are several possible resolutions. First, proactively check for token expiration and ask the user to log in again if the ID token isn't valid. Second, catch the error in a callback passed into the acquiretoken ADAL JS function and ask the user to log in again if the error occurs. Third, whitelist the login.microsoftonline.com endpoint in your browser extension or re-enable third party cookies in your browser if they're disabled. Lastly, add two client applications to Authorized client applications in Azure portal for the Teams desktop/mobile clients and the web client: 5e3ce6c0-2b1f-4285-8d4b-75ee78787346 and 1fec8e78-bce4-4aaf-ab1b-5451cc387264.|

[Back to top](#error-handling-messages)

## Bots

|Error message              |Scenario                               |Resolution  |
|---------------------------|---------------------------------------|------------|
|ServiceError <br>**Reason**: Couldn't find Connection Setting with name teamsAuth.    | The developer was trying to add SSO for a notification bot using Teams Toolkit. Despite following the documentation and adding the OAuth connection in the bot, the developer was encountering an error stating that the connection setting 'teamsAuth' couldn't  be found.        |Ensure that the OAuth connection name is correctly added to the .env file as mentioned in the documentation. If the issue persists, try using the TeamsBotSSOPrompt function by registering an Azure Active Directory App for bot authentication. If the problem still persists, consider filing an issue in the TeamsFx repo for further assistance.|
|BadArgument <br>**Reason**: Unknown attachment type|The developer is trying to attach a PDF file to a Microsoft Teams bot and encounters an error.|The developer should check the sample code for file sharing on MS Teams provided by Microsoft. Additionally, the 'supportsFiles' option needs to be enabled in the manifest for the bot to support file attachments.|
|Bad Request - Error in query syntax. <br>**Reason**: The error occurred while trying to get detailed user information using GetUserProfile() in Microsoft Power Virtual Agents Flow Template|The developer was trying to get detailed user information using Microsoft Power Virtual Agents in Microsoft Teams. The error occurred when the developer tried to use GetUserProfile() function with the input as 'first(outputs('Search_for_users_(V2)')?['body/value'])?['UserPrincipalName']'.|Ensure that the necessary camera and storage permissions are granted on the Android device. Check the app's permission settings and make sure the camera and storage permissions are enabled. If the issue persists, consider debugging the code to identify any potential issues specific to Android.  Instead of passing in display name, pass in UserID. This way, the call to SearchForUsers() isn't needed. Correcting the input to GetUserProfile() function should resolve the issue.|
|BadArgument Failed to decrypt pairwise ID| The error occurred when attempting to create a conversation between a bot and a user in Teams using the POST request to the [endpoint](https://smba.trafficmanager.net/amer/v3/conversations).|Verify the values of each parameter in the request, especially the ID given for the member parameter. If the error persists, try executing the request at a different time as it's a temporary issue.|
|The deep link doesn't save the subEntityId param when clicked in Microsoft Teams chat.|A developer is trying to use a deep link in Microsoft Teams chat, but the subEntityId param isn't  being saved when the link is clicked. Ensure that the 'context' isn't  web encoded. Try using the following format: [https://teams.microsoft.com/l/entity/c38259cb-cd15-4797-b634-098bcea43f9a/index1?webUrl=https://google.com/&label=Google&context={"subEntityId":39138959}|](<https://teams.microsoft.com/l/entity/c38259cb-cd15-4797-b634-098bcea43f9a/index1?webUrl=https://google.com/&label=Google&context={"subEntityId":39138959}>|)
|Error Message: 412 <br>**Reason**: The server crashes when trying to send a 412 response in the onInvokeActivity in the server/bots/botActivityHandler.js.|The developer is using Node 16 and npm 8 in the sample app-sso and encounters a server crash when the botAdaptivity attempts to return a 412 response. The bot-builder doesn't catch and process this exception, causing the app to crash.|Ensure that all required permissions are added and the configuration is correct. Check if admin consent has been granted for your graph APIs. Also, consider adding exception handling in the server or elsewhere to catch and process this exception. An issue has been submitted to botbuilder-js and they have added this problem to their backlog.|
|invalid_grant <br>**Reason**:  Due to a configuration change made by your administrator, or because you moved to a new location, you must use multifactor authentication to access.|The developer is trying to create an MS Teams chatbot using Python and is having difficulty obtaining the correct access token to read the user's group chat and interact with it. The user has multifactor authentication enabled.|The developer needs to use interactive flows where user sign in is required. User should modify the code to use 'acquire_token_interactive' instead of 'acquire_token_by_username_password.' User should add a redirect URI as `http://localhost` in the application.|
|Manifest.json validation errors and meeting join events not getting delivered.|The developer is trying to run a Microsoft Teams bot for meeting events but is encountering validation errors with the manifest.json file. Additionally, the bot isn't receiving meeting join events, although chat messages are arriving.| 1. Ensure that the manifest.json file is correctly formatted and adheres to the schema. 2. Check the bot's permissions and scopes to ensure it has the necessary access to receive meeting join events.  3. Refer to the sample provided by Microsoft at <https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/meetings-events/csharp> for guidance. 4. If the issue persists, reach out to Microsoft support for further assistance.|
|Error finding key for token <br>**Reason**: The system is unable to find the key for the token while testing the command bot app.|The developer was testing a command bot app in Microsoft Teams. When they used @mention to send a 'helloWorld' command to the bot, they received no response and encountered an error message in the Visual Studio Code terminal stating 'Error finding key for token.'|1. Ensure that the bot is properly configured and the token is correctly generated. <br> 2. Check if the RSA public key is correctly set up and matches with the token. <br> 3. Make sure all prerequisites and steps are correctly followed as per the given document. <br> 4. Try to reproduce the issue in a different environment or setup to isolate the issue. <br> 5. If the issue persists, consider reaching out to Microsoft Teams Developer Community or escalating the issue via the provided link.|
|Error Message: 400 <br>**Reason**: Bot isn't responding when using app service url as messaging endpoint.|The developer is trying to use a bot with a deployed service url in Microsoft Teams. The bot works fine with ngrok but fails to respond when using the app service url.|Check if any policy is blocking the request from Teams to App service. If so, modify the policy to allow the request. Also, ensure that the domain where your app is deployed is added under the 'validDomains' section of the manifest. If not using SSO, enter a dummy string value in the 'resource' field of the 'webApplicationInfo' section of your app manifest.|
|Error Message: DEP0005, DEP0018 <br>**Reason**: The bot stopped responding due to deprecation of Buffer() and unhandled promise rejections.|A bot built with Microsoft Bot Framework Node.JS SDK, deployed on a windows server, stopped responding after working well for over a year.|Replace the deprecated Buffer() methods with the new Buffer.alloc(), Buffer.allocUnsafe(), or Buffer.from() methods in your code. Also, handle promise rejections properly in your code to avoid termination of the Node.js process.|
|Invalid URL Invoking a Teams chat via DeepLink to external contacts doesn't work on iOS.|The developer is trying to invoke a Teams chat with external contacts using DeepLink on iOS. The same operation works fine on other platforms like desktop but fails on iOS, returning an 'Invalid URL' error.| Ensure that the URL used to invoke the chat is correctly formatted and valid. Test the URL on different platforms to verify its functionality. If the issue persists, escalate it using the provided link in the Microsoft Teams Developer Community.|
|Bot isn't receiving all channel messages despite having the ChannelMessage.Read.Group RSC permission.|The developer is trying to make a bot receive all channel messages even when not mentioned, as per the documentation. However, the bot isn't receiving all messages unless explicitly mentioned. The developer is also facing issues with the structure of 'webApplicationInfo' in Manifest.json and receiving an error when uploading the manifest.json.|<br> 1. Ensure that the manifest version is v1.12 or above. <br> 2. Add 'token.botframework.com' in valid domains. <br> 3. Remove 'orgWide': [], from the authorization section. <br> 4. The bot-id should be given in the 'webapplicationInfo' section. <br> 5. Refer to the sample provided in the link: [https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/bot-receive-channel-messages-withRSC/csharp](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/bot-receive-channel-messages-withRSC/csharp) and follow the steps.|
|BotNotInConversationRoster Automatic installation of bot isn't working while invoking from message extension.|The developer is trying to automatically install a bot when invoked from a message extension. Despite following the documentation and using an adaptive card with an install button, the bot doesn't get installed.|<br> 1. Ensure that the bot is correctly configured in the manifest.json file. <br> 2. Check the messaging extensions invoke handler in TeamsBot. <br> 3. Verify that the adaptive card is correctly formatted and includes the 'justInTimeInstall' property. <br> 4. Try uploading the app via the Teams admin center instead of sideloading. <br> 5. Test the setup with a different sample to see if the issue persists.|
|Permissions Denied <br>**Reason**: Ask your IT admin to add this app for you.|The developer is trying to add a transcript bot to a chat or a meeting in Microsoft Teams but is encountering a permissions error.|Check if there's any custom policy set up in admin center for this app that isn't allowing it to be added in chat/meeting. Ensure that the options for adding apps to meetings and chats are enabled in the Teams admin center. If all settings are correct, it may take up to 28 days for apps to be fully provisioned. In this case, a manual sync performed by Microsoft support solved the issue.|
|Invalid user identity in provided tenant <br>**Reason**: The bot encountered an error while sending Adaptive Cards to users outside the host's tenant/organization.|The developer is trying to send an Adaptive Card to each member of a meeting using a notification bot. The bot is able to send the card to the meeting creator but throws an error when trying to send to other members.|The bot can only send Adaptive Cards to users within the host's tenant/organization. Add a condition to check if the member's tenantId matches the conversation's tenantId before sending the Adaptive Card. This condition prevents the bot from attempting to send cards to users outside the host's tenant, thus avoiding the error.|
|Bot isn't responding to command messages in Teams channel without an assigned owner.|The issue occurs when a command message is posted in a Teams channel that was created using the Graph API and doesn't have an assigned owner. The bot installed in the channel doesn't respond to the command message.|Ensure that the Teams channel has an assigned owner by checking the channel's settings. If the issue persists, it may be due to an intermittent issue with the Graph API. Monitor the situation and report if the issue reoccurs.|
|context.adapter.getSignInLink isn't a function  <br>**Reason**: The function 'getSignInLink' isn't recognized as a function of 'context.adapter'.|The developer is following a tutorial to implement adaptive cards in a Microsoft Teams bot. The error occurs when trying to use the 'getSignInLink' function with the 'CloudAdapter' class, which isn't recognized as a valid function.|The developer should refer to the provided NodeJS sample where the 'CloudAdapter' class is used. If the issue persists, the developer should ensure they're using the latest version of the repository and consider seeking further examples or documentation on how to use the 'getSignInLink' function with the 'CloudAdapter' class.|
|401 Unauthorized Error Ngrok|The developer is trying to set up a bot for the C# Sequential Flow Adaptive Card but encounters a 401 Unauthorized Error when trying to call the bot and test a sample incident.|Check the messaging endpoint URL in bot registration and ensure it's correctly set to https://<your_ngrok_url>/api/messages. If the issue persists, try reregistering the AAD app, recreating the bot, and changing the settings from single tenant to multi-tenant.|

[Back to top](#error-handling-messages)

## Cards

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|iOS Teams app not showing card if the card contains a hyperlink with an ampersand|The developer is trying to display a card in the iOS Teams app that contains a hyperlink with an ampersand. Instead of displaying the card, the app only shows the message 'Sent a card'|Ensure that the iOS and Teams versions are up to date. If the issue persists, share the card JSON for further investigation. It might be an issue with the way the hyperlink is parsed when it contains an ampersand. As a workaround, try encoding the ampersand in the URL.|
|OnTeamsMeetingStartAsync() and OnTeamsMeetingEndAsync() methods aren't being called in a specific tenant, but work in a local demo tenant.| The developer is trying to use OnTeamsMeetingStartAsync() and OnTeamsMeetingEndAsync() methods in a specific tenant, but they aren't being called. However, these methods work in a local demo tenant.|1. Confirm that the feature is available in public developer preview. 2. Ensure that 'OnlineMeeting.ReadBasic.Chat' permission is added. 3. Check the configuration of group owner consent settings for RSC in a team using the Azure AD portal. 4. Use Graph explorer to check whether the correct RSC permission is associated with the bot.|

[Back to top](#error-handling-messages)

## Developer Portal

|Error message              |Scenario                               |Resolution  |
|---------------------------|---------------------------------------|------------|
|Manifest Error <br>**Reason**: Manifest is invalid due to missing 'name.short' and 'name.full' properties in the localization file   | The developer was trying to upload the manifest for a Teams app with localization. The Teams app started throwing an error stating that the manifest is invalid due to missing 'name.short' and 'name.full' properties in the localization file.|Add 'name.short' and 'name.full' properties to the localization file. Even if the name of the application isn't localizable, these fields are required in the localization file.|
|File not found <br>**Reason**: The file couldn't be found in the app package.| The developer is trying to import the 'Hello World' app package to the Developer Portal in Microsoft Teams. However, the import fails with an error message stating that the file couldn't be found in the app package. The developer has tried both generating the app package using the 'gulp' command and manually creating the app package, but the error persists.|The developer should manually update the color and outline icon file names in the manifest file and check if it works. If the issue persists, the developer should manually create a zip package of color, outline, and manifest file, which is in the appPackage folder and check if it works. If the issue still persists, the developer should check the PR #525 for the updated changes.|
|Error Message: Error converting value "{{variable-name}}" to type 'System.Nullable`1[System.Guid]'. Path 'botId,' line 1, position 31. Can't use environment variable as Bot ID in Teams App Developer Portal.|The developer is trying to use an environment variable as a bot ID while creating a Teams App manifest using the Developer Portal.|Environment variables aren't designed for using in the GUID field. The developer should directly use the GUID value instead of the environment variable in the bot ID field.|
|514 SDK Initialization Failed - <br>**Reason**: Provide instrumentation key|The developer is trying to initialize the Teams SDK in web teams on Chrome browser but it's failing due to missing instrumentation key.|    Ensure that you have provided a valid instrumentation key while initializing the SDK. The instrumentation key is required for telemetry data. If you don't have one, you can create it in Azure portal.|
|Duplicate file error Duplicate readme.md files found in different sample paths.|Found duplicate readme.md files under different 'parent' sample paths while ingesting sample files.|Review the files and determine if they're needed. If not, delete the duplicate files. Raise the PR     to delete the second readme file residing in the /Images/ path. After the changes are pushed to the main branch, check and confirm the changes.|
|SyntaxError <br>**Reason**: Can't use import statement outside a module|The developer is trying to run the Microsoft Teams sample app 'app-hello-world' locally using npm start, but encounters a syntax error related to the import statement.|Add "type": "module", in the package.json file. If the issue persists, follow the steps mentioned in the 'app-hello-world' GitHub sample and refer to the 'Common Issues'section.|
|Provided add-in package wasn't understood. Make sure that the submitted file is a valid Office add-in package.|The error occurred while importing an AppStudio app in the Developer Portal in Teams.|<br> 1. Ensure that the Manifest Version is provided in $schema and manifestVersion. <br> 2. Avoid using reserved IDs 'about' and 'conversations' for entity ID in the manifest. Also, don't specify the 'Name' property if you use reserved IDs. <br> 3. Either provide a value for property 'defaultGroupCapability.meetings' or remove it.|

[Back to top](#error-handling-messages)

## Microsoft Graph

|Error message             |Scenario                               |Resolution  |
|--------------------------|---------------------------------------|------------|
|PreconditionFailed <br>**Reason**: PreconditionFailed-ETag mismatch for thread store resource.   | The error occurred while trying to create a group chat using the $batch API from MS Team Graph API.|Ensure that you're using the correct POST query while creating the group chat. After creating the group chat, try adding members to the chat using batch operation.|
|No authorization information present on the request.|The developer is trying to call a Graph API from the explorer but is encountering an error even though all required permissions have been granted.|Ensure that there's an admin grant for the required permissions. You can also decode your token at [https://jwt.ms](https://jwt.ms) and check in scopes whether the required permissions are available.|
|TerminatingError(Import-Module) <br>**Reason**: Couldn't load file or assembly 'System.Management.Automation, Version=7.2.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system can't find the file specified.|The error occurred when a PowerShell script was executed via Intune on devices other than the developer's own. The script was intended to deploy corporate images to each user's workstation for use as Microsoft Teams backgrounds. The script worked fine when executed locally or on the developer's machine, but failed on other laptops when executed through Intune.|1. Downgrade the PnP PowerShell to version 1.12.0 using the commands: 'Uninstall-Module PnP.PowerShell' and 'Install-Module -Name PnP.PowerShell -RequiredVersion 1.12.0.' 2. If the script is being run in an Azure DevOps release pipeline, force the PowerShell task to run with PowerShell Core instead of the default V5 by updating the task settings under Advanced. 3. If the script is run via Intune, check if there's an option to enforce using PowerShell Core. 4. Alternatively, host the image files on an accessible website and use 'Invoke-WebRequest' to remove the need for interaction with PnP.PowerShell.|
|Forbidden UnknownError|The developer is trying to retrieve messages from a public Microsoft Teams channel that they aren't a part of, using Microsoft Graph APIs.|Ensure that the access token has at least ChannelMessage.Read.All permission. If not, add the required permission and try again. Check the functionality in the Graph Explorer first. Team members, owners, or admins can access GET /teams/team-id/ and even admins can't pull messages from channels they aren't part of. This access control is by design.|
|Batch request against /education/user/{userId} endpoint in Microsoft Graph API isn't returning a 'value' property.|The developer is running a batch request against the /education/user/{userId} endpoint in Microsoft Graph API and isn't receiving a 'value' property in the response.|This isn't a bug but a feature of the Microsoft Graph API. When calling endpoints that return a collection, the batch response contains a 'value' property with a collection of objects. However, when calling endpoints that return a single object, like /education/users/{id}, the batch response directly contains the object. No 'value' property is returned in this case.|

[Back to top](#error-handling-messages)

## Webhook and Connectors

|Error message              |Scenario                              |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|Error Message: 403-Forbidden error <br>**Reason**: When trying to do an HttpPOST request via a message card, delivered via a Custom Connector.| The developer is trying to create a custom connector for their application in Teams. They're able to post message cards using PostMan. But when they try to post a message card with an Action (HttpPOST) and execute it on the click of a button, they receive a 'Failed to send' message. Further inspection reveals that an API called Execute Action is returning a 403 forbidden error.|Check the permissions for the webhook.site URL. Make sure it's added as an Action URL in the connector developer dashboard and as a valid domain in the connector manifest.json. If the issue persists, try using a different webhook.site as suggested by the Microsoft Teams support.|
|Error encountered when trying to mention @webhook name in teams.|The developer is trying to invoke Azure functions from Outgoing webhooks in Microsoft Teams. They have created Outgoing webhooks in teams and added their Azure function URL in the callback URL. They have also copied their secret key from webhooks to Azure configuration. However, when they try to mention @webhook name in teams, they encounter an error.|The developer needs to create an HttpTrigger Azure function instead of just an HttpRequest function. They can refer to the provided code for creating an Azure HttpTrigger function.  For more information, refer to the document on Azure functions and bindings.|

[Back to top](#error-handling-messages)

## Device capabilities

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|No Error Code  <br>**Reason**: Unable to launch camera in android mobile using the provided React-js code snippet| The developer is trying to launch the camera and gallery on both android and iPhone using a React-js code snippet in a Microsoft Teams app. The camera doesn't open on Android, only the gallery opens without multiple selections, while it works fine on iPhone.|Ensure that the necessary camera and storage permissions are granted on the Android device. Check the app's permission settings and make sure the camera and storage permissions are enabled. If the issue persists, consider debugging the code to identify any potential issues specific to Android.|
|10000 / SIZE_EXCEEDED  <br>**Reason**: The error occurs when users select more number of images using the microsoftTeams.media.selectMedia function, exceeding the total file size limit of ~30 MB.|The issue arises when users of the custom message extension, particularly on modern Android devices, select more than five images at once. Each image can be over 6 MB, causing the function to fail due to the total file size limit.|The platform's size boundaries seem to be limited. You can change the maxMediaCount value as mentioned in the code. However, the exact limit varies depending on the device and the size of the images. The engineering team is investigating ways to counter the platform size limit.|
|Option to disable developer previews no longer exists in the stated menu.|A user enabled the developer preview in Microsoft Teams and later found that the option to disable it no longer exists in the menu. The user was unable to disable the developer preview for a year.|The user should update the Teams version and check again. If the issue persists, the user should connect with the tenant admin to disable the policy. If the issue still persists, the user should reach out to Microsoft 365 Product Support.|
|This action can't be performed since the app doesn't exist or has been uninstalled.|The developer is creating a Microsoft Teams messaging bot that requires authentication/sign-in. The bot sends a nonreply message to the user that includes a hero card with a sign-in button. When the user receives the hero card and clicks the sign-in button, it displays an error message.|1. Ensure that 'token.botframework.com' and 'login.microsoftonline.com' are added in the valid domain section of your app manifest. <br> 2. If you're sideloading the app, installing/uninstalling the app can be buggy. Try closing and reopening your MS Teams client.|
|DOMException: Permission denied Unable to get audio record in meeting side panel.|The developer is trying to get audio record in the meeting side panel using TeamsFx-Samples and Recorder.js. The code works in meetingChatTab but fails in meetingSidePanel, with no console error but a DOMException: Permission denied in meetingChatTab (web version).|The developer should ensure that they have manually granted permission at a per app level in the web browser as per the instructions in the Microsoft Teams documentation. However, it should be noted that device permissions in the meetings side panel aren't yet supported in the General/Public ring.|

[Back to top](#error-handling-messages)

## Sideloading

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|Error while importing the Teams custom app after unzipping, zipping, and reimporting.|The developer is trying to import a Teams custom app. The import works fine if the zip is exported and immediately reimported. However, if the zip is exported, unzipped on a Mac or Windows computer, then rezipped and reimported, it fails.|Ensure that when zipping the files, only the three necessary files (manifest file, color and outline icon file) are selected and zipped. Don't zip the entire folder containing these files as it results in the files being buried in a folder, which the dev portal isn't  expecting.|
|Error Message: 403 <br>**Reason**: Failed to create an app in Azure Active Directory due to insufficient privileges.|A user is trying to upload a custom app through Teams but is encountering an error due to insufficient privileges.|Check if the E3 license includes Microsoft Teams. Ensure the user has either the Application Administrator or Application Developer role assigned. If not, assign one of these roles to the user. There might be a delay after assigning the role, so try again after some time. If the error persists, log in with a Microsoft 365 Developer Account. If you don’t have one, consider joining the Microsoft 365 Developer Program.|

[Back to top](#error-handling-messages)

## Tabs

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|Admin Permissions Consent window doesn't close back after granting or canceling permissions in the Desktop/ Mac Teams app.|A developer is building a Microsoft Teams Tab application that requires opening the admin permissions consent page within the app. The consent window works fine on the web version of the application, but on the Desktop/ Mac Teams app, the window doesn't close after granting or canceling permissions.|<br> 1. Don't mix Teams Tab SSO supports and the idea of having an admin do a pre-consent in the same place. Provide a separate link for admin to pre-consent or rely on the standard SSO experience. <br> 2. Use 'microsoftTeams.authentication.getAuthToken', which handles SSO better than 'authentication.authenticate'. <br> 3. Your redirect page should call the 'notifySuccess(…)' method to close the login screen.<br> 4. Mark your app as 'needs admin pre-approval' and set 'defaultBlockUntilAdminAction' to 'true' and 'publisherDocsUrl' to the page with the instructions for the admin.|

[Back to top](#error-handling-messages)

## Task module

|Error message                           |Scenario                               |Resolution  |
|----------------------------------------|---------------------------------------|------------|
|Task Module is empty when opened in Teams desktop or web app, but works fine in Teams mobile app.|A chat bot was created to send adaptive cards with buttons that start task modules. However, when these task modules are opened in Teams desktop or web app, they appear empty. The issue doesn't occur in Teams mobile app.|Check if 'showLoadingIndicator' is set to true in your manifest. If it's, ensure that you have implemented the corresponding protocol for showing the loading indicator as per Microsoft's documentation. If the issue persists, consider debugging your code to identify any potential issues with the task module's implementation.|
|X-Frame-Options set to 'deny' <br>**Reason**: The application proxy doesn't work in Teams Desktop Task Module due to login.microsoftonline.com authentication.|The developer is trying to update an app to allow users to open their on-premises sites in the Teams task window using AAD, Enterprise application, Application Proxy and assigned users. The app works fine on mobile and browser but fails on the Desktop application with an error related to 'X-Frame-Options'.|Ensure that the website used is iFramable and is included in the valid domains of the Manifest. Set the Content-Security-Policy header to 'frame-ancestors teams.microsoft.com *.teams.microsoft.com*.skype.com'. For Internet Explorer 11 compatibility, set X-Content-Security-Policy. Alternatively, set the X-Frame-Options header to 'ALLOW-FROM [Teams](https://teams.microsoft.com/)'. Refer to the documentation for tab requirements in Microsoft Teams.|
|Unable to load a different TeamsJS app inside of a task module/dialog.|The developer was trying to load another app inside of a different app's tab using a Task Module in Microsoft Teams.|The developer can't load a different TeamsJS app inside of a task module/dialog. The loading information and context is based on the manifest of the app that triggered the dialog. The developer can use deep links instead of tasks.startTask method.|

[Back to top](#error-handling-messages)
